<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
		<title>æ²®çˆ¹çº¢åˆ©æœŸæ¨¡æ‹Ÿå™¨</title>
		<style>
			body {
				font-family: Arial, sans-serif;
				margin: 10px;
				overflow-x: hidden;
			}

			#deck {
				margin-top: 15px;
			}

			.card {
				background-color: #f0f0f0;
				border: 1px solid #ccc;
				padding: 8px;
				margin: 4px;
				display: inline-block;
				width: 130px;
				text-align: center;
			}

			#remaining {
				margin-top: 15px;
				border: 2px solid #ccc;
				padding: 8px;
				width: auto;
			}

			.highlight {
				background-color: #ffcccc;
			}

			.header {
				position: fixed;
				top: 0;
				width: 100%;
				background-color: #333;
				color: #fff;
				padding: 8px 0;
				text-align: center;
				z-index: 1000;
				box-sizing: border-box;
			}

			.header-plaeholder {
				height: 50px;
				width: 100%;
			}

			#remaining-counts {
				background-size: cover;
				position: relative;
				margin: 10px 0;
				padding: 8px;
				border: 2px solid #ddd;
				background-color: #f9f9f9;
			}

			#remaining-counts::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(255, 255, 255, 0.7);
				z-index: 0;
			}

			#remaining-counts .category {
				position: relative;
				z-index: 1;
			}

			.category {
				margin: 8px 0;
				padding: 4px;
				border-bottom: 2px solid #ccc;
			}

			.category-title {
				font-weight: bold;
				color: #333;
				margin-bottom: 4px;
			}

			.count-item {
				display: inline-block;
				width: 100px;
				padding: 2px;
				font-size: 13px;
			}

			footer {
				background-color: #000;
				color: #fff;
				padding: 8px 0;
				text-align: center;
				font-family: Arial, sans-serif;
			}

			.tooltip-container {
				position: relative;
				display: inline-block;
				margin: 15px;
				margin-left: 2em;
			}

			.tooltip {
				visibility: hidden;
				background-color: #555;
				color: #fff;
				text-align: center;
				border-radius: 4px;
				padding: 6px;
				position: absolute;
				z-index: 1;
				top: 125%;
				opacity: 0;
				transition: opacity 0.3s;
				min-width: 200px;
				max-width: 350px;
				white-space: normal;
				box-sizing: border-box;
				left: 50%;
				transform: translateX(-50%);
				pointer-events: none;
				margin-left: 0;
				margin-right: 0;
				width: auto;
				max-width: calc(100vw - 20px);
				left: calc(50% + 1em) !important;
				transform: translateX(-50%) !important;
			}

			button {
				margin-right: 8px;
				margin-left: 0;
				padding: 5px 10px;
				border-radius: 4px;
				cursor: pointer;
				transition: all 0.2s;
			}

			.tooltip::after {
				content: "";
				position: absolute;
				bottom: 100%;
				left: 50%;
				margin-left: -5px;
				border-width: 5px;
				border-style: solid;
				border-color: transparent transparent #555 transparent;
			}

			.tooltip.right-align {
				left: auto;
				right: 0;
				transform: none;
			}

			.tooltip.right-align::after {
				right: 20px;
				left: auto;
				margin-left: 0;
			}

			.tooltip-container:hover .tooltip {
				visibility: visible;
				opacity: 1;
			}

			#hand {
				margin: 15px 0;
			}

			button {
				margin-right: 8px;
			}

			.phase {
				color: red;
				margin: 8px;
			}

			.card {
				padding: 6px;
				margin: 3px;
				border: 1px solid #ccc;
				border-radius: 4px;
				font-family: monospace;
			}

			#log-container {
				border: 2px solid #666;
				border-radius: 8px;
				padding: 8px;
				margin: 15px 0;
				max-height: 150px;
				overflow-y: auto;
				background-color: #f8f8f8;
				display: flex;
				flex-direction: column;
			}

			#log {
				display: flex;
				flex-direction: column-reverse;
			}

			#log p {
				margin: 4px 0;
				padding: 2px;
				border-bottom: 1px dotted #ddd;
				animation: slideDown 0.3s ease;
			}

			@keyframes slideDown {
				from {
					opacity: 0;
					transform: translateY(-10px);
				}

				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			#remaining-counts {
				transition: all 0.3s ease;
				overflow: hidden;
			}

			.collapsed {
				max-height: 0 !important;
				opacity: 0;
				padding: 0 !important;
				border: none !important;
			}

			#deck {
				transition: all 0.3s ease;
			}

			.shuffling {
				position: relative;
				animation: deckShuffle 1.2s cubic-bezier(0.4, 0, 0.2, 1);
				filter: drop-shadow(0 0 12px rgba(255, 215, 64, 0.6));
			}

			.card.shuffle-item {
				animation: cardShuffle 0.8s ease-in-out both;
				transform-origin: 50% 100%;
			}

			@keyframes deckShuffle {
				0% {
					transform: translateY(0) rotateZ(0deg);
					opacity: 1;
				}

				30% {
					transform: translateY(-20px) rotateZ(-5deg);
					opacity: 0.9;
				}

				70% {
					transform: translateY(10px) rotateZ(5deg);
					opacity: 0.95;
				}

				100% {
					transform: translateY(0) rotateZ(0deg);
					opacity: 1;
				}
			}

			@keyframes cardShuffle {
				0% {
					transform: rotateZ(0deg) scale(1);
					z-index: 1;
				}

				25% {
					transform: rotateZ(-15deg) scale(1.05);
					z-index: 2;
				}

				50% {
					transform: rotateZ(15deg) scale(0.95);
					filter: brightness(1.2);
				}

				75% {
					transform: rotateZ(-10deg) scale(1.02);
					filter: brightness(1.1);
				}

				100% {
					transform: rotateZ(0deg) scale(1);
					z-index: 1;
				}
			}

			@media (prefers-reduced-motion: no-preference) {

				.shuffling,
				.card.shuffle-item {
					will-change: transform, filter;
					backface-visibility: hidden;
				}
			}

			.md5-panel {
				margin: 15px 0;
				padding: 10px;
				border: 2px solid #BBDEFB;
				border-radius: 8px;
				background: #E3F2FD;
				box-shadow: 0 2px 4px rgba(33, 150, 243, 0.1);
			}

			.md5-display {
				display: flex;
				align-items: center;
				gap: 10px;
			}

			#md5Value {
				font-family: 'Courier New', monospace;
				font-size: 13px;
				letter-spacing: 1px;
				padding: 6px 10px;
				background: #FFF;
				border: 1px solid #64B5F6;
				border-radius: 4px;
				flex-grow: 1;
				user-select: none;
				min-width: 220px;
				color: #1976D2;
			}

			.aes-panel {
				margin: 15px 0;
				padding: 10px;
				border: 2px solid #C8E6C9;
				border-radius: 8px;
				background: #E8F5E9;
				box-shadow: 0 2px 4px rgba(76, 175, 80, 0.1);
			}

			#aesValue {
				font-family: 'Courier New', monospace;
				font-size: 18px;
				letter-spacing: 0.5px;
				padding: 8px;
				background: #fff;
				border: 1px solid #b3e5fc;
				border-radius: 6px;
				flex-grow: 1;
				user-select: none;
				min-width: 240px;
				word-break: break-all;
				white-space: pre-wrap;
				line-height: 1.5;
				color: #01579b;
				box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
				transition: all 0.3s ease;
				max-height: 120px;
				overflow-y: auto;
			}

			#aesValue:hover {
				border-color: #81d4fa;
				box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
			}

			#aesValue::-webkit-scrollbar {
				height: 4px;
				background-color: #E8F5E9;
			}

			#aesValue::-webkit-scrollbar-thumb {
				background: #4CAF50;
				border-radius: 2px;
			}

			.md5-buttons {
				flex-shrink: 0;
				margin-left: 10px;
			}

			.md5-display {
				overflow: visible;
				flex-wrap: nowrap;
			}

			.md5-button {
				padding: 5px 10px;
				border-radius: 4px;
				cursor: pointer;
				transition: all 0.2s;
			}

			#toggleMD5,
			#copyMD5 {
				border: 1px solid #2196F3;
				color: #2196F3;
				background: none;
			}

			#toggleMD5:hover,
			#copyMD5:hover {
				background: #2196F3;
				color: white;
			}

			#toggleAES,
			#copyAES {
				border: 1px solid #4CAF50;
				color: #4CAF50;
				background: none;
			}

			#toggleAES:hover,
			#copyAES:hover {
				background: #4CAF50;
				color: white;
			}

			#verifyResult {
				font-weight: bold;
				padding: 3px 6px;
				border-radius: 3px;
			}

			#verifyResult[style*="4CAF50"] {
				background: #E8F5E9;
			}

			#verifyResult[style*="f44336"] {
				background: #FFEBEE;
			}

			#verifyAESResult {
				font-weight: bold;
				padding: 3px 6px;
				border-radius: 3px;
			}

			#verifyAESResult:empty {
				display: none;
			}

			.md5-button.copied {
				background-color: #4CAF50 !important;
				color: white !important;
				transition: all 0.3s ease;
			}

			.security-alert {
				font-family: 'å¾®è½¯é›…é»‘', sans-serif;
				padding: 15px;
				border-radius: 8px;
				background: #f8f9fa;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
				max-width: 90%;
				line-height: 1.6;
			}

			.security-alert strong {
				color: #d32f2f;
			}

			.security-alert button {
				margin: 8px 4px 0 0;
				padding: 6px 16px;
				border-radius: 4px;
				cursor: pointer;
			}

			.security-alert .confirm {
				background: #4CAF50;
				color: white;
				border: none;
			}

			.security-alert .cancel {
				background: #f44336;
				color: white;
				border: none;
			}

			#md5aes-container {
				transition: all 0.3s ease;
				overflow: hidden;
				max-height: 1500px;
			}

			#md5aes-container.collapsed {
				max-height: 0 !important;
				opacity: 0;
				padding: 0 !important;
				border: none !important;
			}

			.chain-dialog button {
				margin: 4px;
				padding: 6px 12px;
				border: 1px solid #666;
				cursor: pointer;
			}

			.chain-dialog button:hover {
				background: #f0f0f0;
			}

			#func1 {
				background: #BBDEFB;
			}

			#func2 {
				background: #C8E6C9;
			}

			#cancel {
				background: #FFCDD2;
			}

			#status-area {
				display: grid;
				grid-template-columns: 1fr 2fr;
				/* å·¦åˆ—å 1ä»½ï¼Œå³åˆ—å 2ä»½ */
				gap: 20px;
				padding: 15px;
				background-color: #f8f9fa;
				border-radius: 8px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				margin: 15px 0;
			}

			/* å·¦ä¾§çŠ¶æ€ä¿¡æ¯ */
			.status-left {
				display: flex;
				flex-direction: column;
				gap: 12px;
			}

			#damage-counter {
				display: flex;
				flex-direction: column;
				gap: 8px;
				padding: 10px;
				background-color: #ffeef0;
				border-radius: 6px;
				border-left: 4px solid #f44336;
			}

			#total-damage,
			#turn-damage {
				font-size: 14px;
				font-weight: bold;
			}

			#kill-counter,
			#zhuge-status,
			#peach-counter,
			#wine-counter {
				padding: 10px;
				background-color: #e3f2fd;
				border-radius: 6px;
				border-left: 4px solid #2196F3;
				font-size: 14px;
				font-weight: bold;
			}

			#kill-counter {
				font-weight: bold;
				color: #c62828;
				margin: 4px 0;
			}

			#zhuge-status {
				color: #2e7d32;
				margin: 4px 0;
			}

			.disabled {
				opacity: 0.5;
				pointer-events: none;
			}

			.tooltip-container button::after {
				content: attr(data-shortcut);
				margin-left: 6px;
				color: #666;
				font-size: 0.8em;
			}

			button {
				position: relative;
			}

			button::after {
				content: attr(data-shortcut);
				position: absolute;
				right: 6px;
				bottom: 2px;
				font-size: 0.8em;
				color: #666;
			}

			.tooltip#cardSelector {
				max-width: 500px;
				padding: 12px;
			}

			.tooltip#cardSelector button {
				min-width: 80px;
				padding: 4px;
				font-size: 13px;
			}

			.card-selector-modal {
				position: fixed;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				background: white;
				padding: 15px;
				border: 2px solid #666;
				z-index: 10000;
				box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
				max-width: 90%;
				max-height: 90vh;
				overflow-y: auto;
			}

			.modal-backdrop {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(0, 0, 0, 0.5);
				z-index: 9999;
			}

			.card-button {
				margin: 4px;
				padding: 6px 12px;
				min-width: 100px;
			}

			.bili-button {
				display: inline-flex;
				align-items: center;
				padding: 10px 38px;
				background: #f46674;
				color: white !important;
				border-radius: 4px;
				transition: opacity 0.3s;
			}

			.bili-button:hover {
				opacity: 0.9;
			}

			.site-footer {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 15px;
				padding: 1.5rem 3%;
			}

			.buttoncopy {
				color: white !important;
				text-decoration: none !important;
				display: inline-block;
				padding: 10px 20px;
				border-radius: 4px;
				background: #C71D23;
				font-weight: 500;
				transition: all 0.3s ease;
				border: 2px solid transparent;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}

			.buttoncopy:hover {
				transform: translateY(-1px);
				box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
				background: #A3171C;
			}

			.buttoncopy:active {
				transform: translateY(0);
				box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
			}

			.site-footer a {
				text-decoration: none !important;
				color: #ADD8E6 !important;
			}

			.license-link:hover {
				opacity: 0.8;
				text-decoration: underline !important;
			}

			.i18n-annotation {
				color: rgba(255, 255, 255, 0.7) !important;
			}

			#testUniformBtn {
				background-color: #4CAF50;
				color: white;
			}

			.security-alert strong {
				color: #d32f2f;
				font-size: 1.1em;
				display: block;
				margin-bottom: 12px;
			}

			.security-alert ul {
				margin: 8px 0;
				padding-left: 20px;
			}

			.security-alert li {
				list-style-type: 'â–¸ ';
				margin: 6px 0;
				color: #666;
			}

			.security-alert .confirm {
				background: #4CAF50 !important;
			}

			.security-alert .cancel {
				background: #f44336 !important;
			}

			.scrollable-panel {
				overflow-y: auto;
				max-height: 90vh;
			}

			.scrollable-panel::-webkit-scrollbar {
				width: 10px;
			}

			.scrollable-panel::-webkit-scrollbar-track {
				background: #f1f1f1;
				border-radius: 10px;
			}

			.scrollable-panel::-webkit-scrollbar-thumb {
				background: #4CAF50;
				border-radius: 10px;
			}

			.scrollable-panel::-webkit-scrollbar-thumb:hover {
				background: #3e8e41;
			}

			@media (max-width: 768px) {
				body {
					margin: 8px;
				}

				.header {
					padding: 6px 0;
					font-size: 14px;
				}

				.header-plaeholder {
					height: 45px;
				}

				.card {
					width: 110px;
				}

				#remaining {
					width: auto;
				}

				.count-item {
					width: 90px;
					font-size: 12px;
				}

				.md5-panel,
				.aes-panel {
					padding: 10px;
				}

				#md5Value,
				#aesValue {
					font-size: 12px;
					min-width: 180px;
				}

				.buttoncopy {
					padding: 8px 16px;
				}

				.security-alert {
					padding: 12px;
				}

				.card-selector-modal {
					max-width: 95%;
				}

				.scrollable-panel {
					width: 95% !important;
					padding: 15px !important;
				}

				#rerunTest,
				#closePanel {
					display: block;
					width: 100%;
					margin: 8px 0;
				}

				.scrollable-panel h2 {
					margin-top: 30px;
				}

				.scrollable-panel>div>div {
					position: relative !important;
					top: auto !important;
					right: auto !important;
					flex-direction: column;
				}

				.monospace {
					font-size: 12px !important;
				}

				progress {
					height: 6px;
				}

				#status-area {
					grid-template-columns: 1fr;
				}

				#delay-area {
					flex-direction: column;
				}

				.delay-section {
					min-width: 100%;
					max-width: 100%;
				}
			}

			@media (max-width: 480px) {
				.scrollable-panel {
					max-height: 85vh !important;
				}

				.md5-button,
				.dialog-button {
					padding: 8px 12px !important;
					font-size: 14px !important;
				}

				.log-panel {
					max-height: 200px;
					overflow-y: auto;
				}

				#status-area {
					grid-template-columns: 1fr;
				}

				#delay-area {
					flex-direction: column;
				}

				.delay-section {
					min-width: 100%;
					max-width: 100%;
				}
			}

			/* å»¶æ—¶é”¦å›ŠåŒºåŸŸæ ·å¼ */
			#delay-area {
				display: flex;
				gap: 15px;
				justify-content: space-between;
			}

			.delay-section {
				flex: 1;
				min-width: 120px;
				max-width: 200px;
				border: 1px solid #b38b6d;
				border-radius: 8px;
				padding: 10px;
				background: #fff8e1;
				display: flex;
				flex-direction: column;
			}

			.delay-section h4 {
				margin: 0 0 8px;
				text-align: center;
				color: #8d6e63;
				font-size: 14px;
				border-bottom: 1px solid #b38b6d;
				padding-bottom: 5px;
			}

			.delay-cards {
				flex-grow: 1;
				min-height: 80px;
				display: flex;
				flex-wrap: wrap;
				gap: 5px;
				justify-content: center;
				align-items: flex-start;
			}

			.delay-card {
				padding: 6px;
				margin: 3px 0;
				background-color: #f0f0f0;
				border: 1px solid #ddd;
				border-radius: 4px;
				text-align: center;
				font-size: 12px;
				flex: 0 0 calc(50% - 10px);
			}

			.delay-card.disabled {
				color: #999;
				font-style: italic;
			}


			/* å»¶æ—¶é”¦å›ŠåŒºåŸŸæ ‡é¢˜æ ·å¼ */
			.delay-section h4 {
				margin: 10px 0 5px;
				font-size: 14px;
				color: #555;
			}

			/* å¯¹è¯æ¡†æ ·å¼ */
			.modal-backdrop {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: rgba(0, 0, 0, 0.5);
				z-index: 9999;
				display: flex;
				justify-content: center;
				align-items: center;
			}

			.card-selector-modal {
				background: white;
				padding: 25px;
				border-radius: 12px;
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
				min-width: 400px;
				max-width: 90vw;
				text-align: center;
			}

			.dialog-button {
				padding: 12px 20px;
				border: none;
				border-radius: 6px;
				cursor: pointer;
				font-size: 16px;
				transition: all 0.2s;
				margin-top: 15px;
			}

			.dialog-button:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			}

			/* å¯é€‰æ‹©çš„å»¶æ—¶é”¦å›Šæ ·å¼ */
			.delay-card-selectable {
				padding: 10px;
				border: 2px solid #8d6e63;
				border-radius: 8px;
				background: #fff8e1;
				cursor: pointer;
				transition: all 0.3s;
				min-width: 100px;
				text-align: center;
			}

			.delay-card-selectable:hover {
				transform: translateY(-5px);
				box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
				background: #ffecb3;
			}

			/* ä¸åŒé”¦å›Šç±»å‹çš„é¢œè‰²åŒºåˆ† */
			.delay-card-selectable:nth-child(odd) {
				background: #e8f5e9;
				/* ä¹ä¸æ€èœ€æµ…ç»¿è‰² */
			}

			.delay-card-selectable:nth-child(even) {
				background: #fff8e1;
				/* å…µç²®å¯¸æ–­æµ…é»„è‰² */
			}

			/* å¯é€‰æ‹©çš„å»¶æ—¶é”¦å›Šæ ·å¼  */
			.delay-card-selectable {
				padding: 10px;
				border: 2px solid #4caf50;
				/* ç»¿è‰²è¾¹æ¡†è¡¨ç¤ºè·å– */
				border-radius: 8px;
				background: #e8f5e9;
				/* æµ…ç»¿è‰²èƒŒæ™¯ */
				cursor: pointer;
				transition: all 0.3s;
				min-width: 100px;
				text-align: center;
				margin-bottom: 8px;
			}

			.delay-card-selectable:hover {
				transform: translateY(-5px);
				box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
				background: #c8e6c9;
				/* æ‚¬åœæ—¶åŠ æ·±èƒŒæ™¯è‰² */
			}

			/* ä¸åŒé”¦å›Šç±»å‹çš„é¢œè‰²åŒºåˆ† */
			.delay-card-selectable.bingliang {
				border-color: #ff9800;
				/* å…µç²®å¯¸æ–­æ©™è‰²è¾¹æ¡† */
				background: #fff3e0;
				/* å…µç²®å¯¸æ–­æµ…æ©™è‰²èƒŒæ™¯ */
			}

			.delay-card-selectable.lebu {
				border-color: #2196f3;
				/* ä¹ä¸æ€èœ€è“è‰²è¾¹æ¡† */
				background: #e3f2fd;
				/* ä¹ä¸æ€èœ€æµ…è“è‰²èƒŒæ™¯ */
			}

			#status-area {
				display: grid;
				grid-template-columns: 1fr 2fr;
				gap: 20px;
				padding: 15px;
				background-color: #f8f9fa;
				border-radius: 8px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				margin: 15px 0;
				box-sizing: border-box;
				width: 100%;
			}

			#status-area.collapsed {
				display: none;
			}

			/* æ•´ç†æ‰‹ç‰ŒæŒ‰é’®æ ·å¼ */
			#organizeHandBtn {
				transition: all 0.3s ease;
				cursor: pointer;
			}

			#organizeHandBtn:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
			}

			#organizeHandBtn:disabled {
				cursor: not-allowed;
			}

			/* ç«æ”»å¯¹è¯æ¡†æ ·å¼ */
			.huogong-dialog,
			.huogong-options,
			.discard-options {
				z-index: 10002;
			}

			.discard-card {
				border: 1px solid #ccc;
				border-radius: 5px;
				padding: 10px;
				cursor: pointer;
				background: white;
				transition: all 0.3s;
				min-width: 80px;
			}

			.discard-card:hover {
				transform: translateY(-3px);
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
				background: #fff9c4;
			}
		</style>
	</head>
	<body>
		<div class="header">
			<p>æ“ä½œå°</p>
			<button id="reloadButton"
				style="margin-left: 15px; background-color: #ff4444; color: white;">å¼ºåˆ¶åˆ·æ–°ï¼ˆQï¼‰</button>
			<button id="draw1Button">å‘1å¼ ç‰Œï¼ˆ1ï¼‰</button>
			<button id="draw2Button">å‘2å¼ ç‰Œï¼ˆ2ï¼‰</button>
			<button id="draw3Button">å‘3å¼ ç‰Œï¼ˆ3ï¼‰</button>
			<button id="draw4Button">å‘4å¼ ç‰Œï¼ˆ4ï¼‰</button>
			<button id="revealButton">æŸ¥çœ‹å‰©ä½™ç‰Œå †ï¼ˆWï¼‰</button>
			<button id="highlightButton">é«˜äº®è¯¸è‘›è¿å¼©ï¼ˆEï¼‰</button>
			<button id="shuffleButton">é‡æ–°æ´—ç‰Œï¼ˆRï¼‰</button>
			<button id="reshuffleBtn" disabled>ä½¿ç”¨è„šæ°”å¡ï¼ˆTï¼‰</button>
			<button id="drawBtn">è¿›å…¥æ‘¸ç‰Œé˜¶æ®µï¼ˆAï¼‰</button>
			<button id="playBtn" disabled>è¿›å…¥å‡ºç‰Œé˜¶æ®µï¼ˆSï¼‰</button>
			<button id="endPlayBtn" disabled>ç»“æŸå‡ºç‰Œé˜¶æ®µï¼ˆDï¼‰</button>
			<button id="testCardBtn">æµ‹è¯•åŠŸèƒ½ï¼šæ·»åŠ æŒ‡å®šç‰Œ</button>
			<button id="testUniformBtn">æ´—ç‰Œå‡åŒ€æ€§æµ‹è¯•</button>
		</div>
		<div class="header-placeholder"></div>
		<h1>æ²®çˆ¹çº¢åˆ©æœŸæ¨¡æ‹Ÿå™¨V5.6å•æœºç‰ˆ</h1>
		<h2>æ³¨ï¼šæœ¬æ¨¡æ‹Ÿå™¨å·²æ¥å…¥GitHub Pagesé™æ€ç½‘é¡µæ‰˜ç®¡åŠŸèƒ½ï¼Œç½‘é¡µé“¾æ¥ï¼š<a href="https://1145141919810tonny.github.io/sgsmoniqi/"
				target="_blank">https://1145141919810tonny.github.io/sgsmoniqi/</a><br/>
			GitHubä¸‹è½½zipç›´é“¾ï¼š<a href="https://github.com/1145141919810TONNY/sgsmoniqi/archive/refs/heads/main.zip"
				target="_blank">https://github.com/1145141919810TONNY/sgsmoniqi/archive/refs/heads/main.zip</a></h2>
		<div class="tooltip-container">
			<button>V2.0æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æ–°å¢äº†å‰©ä½™ç‰Œåçš„æ˜¾ç¤º<br />
				2.æ·»åŠ äº†1.0ç‰ˆæœ¬é‡Œç‰Œå †æ¼æ‰çš„5å¼ é…’<br />
				3.æ–°å¢æŠ½åˆ°akæç¤º<br />
				4.ä¼˜åŒ–å¹¶ç½®é¡¶äº†äº¤äº’æŒ‰é’®
			</div>
		</div>
		<div class="tooltip-container">
			<button>V2.1æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æ–°å¢äº†è„šæ°”å¡çš„ä½¿ç”¨ï¼Œåœ¨å‘çš„ç‰Œç­‰äº4å¼ ä¸”æ¯æ¬¡æ´—ç‰Œæ—¶å°‘äº7æ¬¡å¯ä½¿ç”¨<br />
				2.ä¼˜åŒ–äº†æ›´æ–°å†…å®¹çš„æ’ç‰ˆï¼Œæ›´åŠ ç®€æ´ç•Œé¢<br />
				3.ä¼˜åŒ–äº†åŸºé”¦è£…çš„ç»„åˆä»£ç ï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´<br />
				4.æ›´æ–°äº†è¾ƒå®Œæ•´çš„æ³¨é‡Šï¼Œç½‘é¡µç«¯æµè§ˆå™¨å¯æŒ‰F12æŸ¥çœ‹å¹¶å­¦ä¹ 
			</div>
		</div>
		<div class="tooltip-container">
			<button>V3.0æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æ–°å¢äº†æ¨¡æ‹Ÿå‡ºç‰Œé˜¶æ®µï¼ˆåŠŸèƒ½å°šæœªå®Œå–„ï¼‰<br />
				2.æ–°å¢äº†æ ‡æ²®æˆçš„æŠ€èƒ½ä»£ç ï¼ˆéœ€è¦è¿›å…¥å‡ºç‰Œé˜¶æ®µæ‰å¯ä½¿ç”¨ï¼‰<br />
				3.åˆ·æ–°ç‰Œå †è‡ªåŠ¨å‘4å¼ ç‰Œ<br />
				4.ä¼˜åŒ–äº†ç‰Œå †ä»£ç ï¼Œå¤§å¹…åº¦å‡å°‘ç‰Œå †ä»£ç çš„è‡ƒè‚¿åº¦<br />
				5.æ–°å¢æ—¥å¿—åŒº<br />
				6.æ–°å¢å±•å¼€å’Œæ”¶èµ·è®°ç‰Œå™¨çš„æŒ‰é’®<br />
				7.æ–°å¢åˆ·æ–°ç½‘é¡µæŒ‰é’®<br />
				8.é‡‡ç”¨äº†æ–°çš„ç‰Œå †éšæœºä»£ç æ–¹å¼ï¼Œä»¤å…¶æ›´åŠ å®‰å…¨çš„ä¸”æ›´åŠ æ¥è¿‘çœŸéšæœºç‰Œå †ï¼Œå¹¶ä¸”è®©æ–°ç®—æ³•å°è¯•é€‚é…è¾ƒæ—§çš„æµè§ˆå™¨<br />
				9.ä¿®å¤äº†ç‰Œå †ä»£ç é‡Œçš„ä¸€äº›èŠ±è‰²çš„æ ¼å¼ä¸ä¸€å¯¼è‡´æ¸è¥æ— æ³•æ­£ç¡®è§¦å‘çš„bug
			</div>
		</div>
		<div class="tooltip-container">
			<button>V3.1æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æ–°å¢MD5ç çš„ç”Ÿæˆä¸æ ¡æ£€<br />
				2.æ–°å¢ç»“æŸå‡ºç‰Œé˜¶æ®µæŒ‰é’®ï¼Œä»¥ä¾¿æ—¥ååŠŸèƒ½æ›´æ–°ã€‚<br />
				3.æ–°å¢AESç¼–ç çš„ç”Ÿæˆä¸æ ¡æ£€ï¼Œå¹¶ä¸MD5ç è”åˆç»‘å®šï¼Œä¸”å¯è§£ç ä»–äººåˆ†äº«çš„æœ¬æ¨¡æ‹Ÿå™¨ç”Ÿæˆçš„AESç¼–ç å†…å®¹ã€‚AESç ç”Ÿæˆæ—¶ï¼Œä¼šæ’é™¤æ‰å¼€å±€å‘çš„4å¼ ç‰Œï¼Œåªä¼šç”Ÿæˆå‰©ä¸‹çš„156å¼ ç‰Œ<br />
				4.æ–°å¢ç‰Œå †æ—¥å¿—çš„ç”Ÿæˆã€‚è¯¥åŠŸèƒ½åªèƒ½åœ¨windowsç³»ç»Ÿå†…ä½¿ç”¨ã€‚ï¼ˆæœ‰å¯èƒ½æ£€æµ‹ä¸åˆ°æ˜¯å¦windowsï¼Œä¸ç®¡äº†ï¼‰<br />
				5.åœ¨è®°ç‰Œå™¨åŒºåŸŸèƒŒæ™¯é€šè¿‡base64ç¼–ç åŠ ä¸Šæ²®çˆ¹å¸…æ°”çš„è„¸åºï¼Œæœ¬åœ°ä¹Ÿå¯ä»¥çœ‹åˆ°æ²®çˆ¹å¸…æ°”çš„è„¸åºåŠ›ï¼
			</div>
		</div>
		<div class="tooltip-container">
			<button>V3.2æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æ–°å¢ä»¥ä¸‹å¡ç‰Œçš„ä½œç”¨ï¼š<br />
				1.1ã€æ— ä¸­ç”Ÿæœ‰ã€‘ï¼šé¢å¤–æ‘¸ä¸¤å¼ ç‰Œ<br />
				1.2ã€é“ç´¢è¿ç¯ã€‘ï¼šåŠŸèƒ½1ï¼šé‡é“¸æ‘¸ä¸€å¼ ç‰Œï¼Œä¸æ£€ç´¢èŠ±è‰²ç‚¹æ•°<br />
				åŠŸèƒ½2ï¼šä¸æ‘¸ç‰Œï¼Œä½¿ç”¨å¹¶æ£€ç´¢èŠ±è‰²ç‚¹æ•°ã€‚<br />
				1.3æ–°å¢ã€æ€ã€‘çš„ä½¿ç”¨æ¬¡æ•°é™åˆ¶,é»˜è®¤ä¸º2æ¬¡ï¼Œä½¿ç”¨2æ¬¡åä¼šè¢«ç¦ç”¨ï¼Œç›´åˆ°ç»“æŸå‡ºç‰Œé˜¶æ®µ<br />
				1.4ã€è¯¸è‘›è¿å¼©ã€‘ï¼šè§£é™¤ã€æ€ã€‘çš„ä½¿ç”¨æ¬¡æ•°é™åˆ¶<br />
				1.5æ–°å¢ã€æ¡ƒã€‘ã€é…’ã€‘çš„æ­£ç¡®ä½¿ç”¨æ¬¡æ•°ï¼ˆç•Œæ²®æˆå¼€å±€å°‘1æ»´è¡€ï¼‰<br />
				1.6å¸¸è§„ä¸‹ï¼Œç¦ç”¨ã€é—ªã€‘çš„ä½¿ç”¨ï¼ˆåŠŸèƒ½åç»­ä¼šç»§ç»­å¼€å‘ï¼‰<br />
				2.æ–°å¢çŠ¶æ€ä¿¡æ¯åŒºï¼ˆè¯¥åŒºåŸŸä»¥åä¼šé€æ¸æ–°å¢åŠŸèƒ½ï¼‰
			</div>
		</div>
		<div class="tooltip-container">
			<button>V3.3æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æ–°å¢æ“ä½œå°çš„å¿«æ·é”®<br />
				2.æ–°å¢ä»¥ä¸‹ç‰Œçš„ä½œç”¨ï¼š<br />
				2.1ï¼šã€å€Ÿåˆ€æ€äººã€‘ï¼šåŠŸèƒ½1:ä»ç‰Œå †é‡Œæ£€ç´¢å¹¶è·å¾—ä¸€å¼ æ­¦å™¨ç‰Œ<br />
				åŠŸèƒ½2:è®©è‡ªå·±èƒ½ä½¿ç”¨ä¸€å¼ é—ªï¼Œå¦‚æœä¸ä½¿ç”¨é—ªçš„è¯ï¼ŒçŠ¶æ€åŒºæ¡ƒå¯ä½¿ç”¨çš„æ¬¡æ•°+1<br />
				2.2ï¼šå¸¸æ€ç¦ç”¨ã€æ— æ‡ˆå¯å‡»ã€‘çš„ä½¿ç”¨ã€‚<br />
				2.3ï¼šã€æ¡ƒå›­ç»“ä¹‰ã€‘-1æ¬¡æ¡ƒçš„å¯ä½¿ç”¨æ¬¡æ•°ã€‚<br />
				3.æ–°å¢æµ‹è¯•åŠŸèƒ½ï¼šæ‰‹åŠ¨æ·»åŠ æŒ‡å®šç‰Œåˆ°æ‰‹ç‰ŒåŒºï¼ˆæ–¹ä¾¿æˆ‘è‡ªå·±æµ‹è¯•å¡ç‰Œçš„bugæ—¶ä½¿ç”¨ï¼‰<br />
				4.åˆ é™¤è®°ç‰Œå™¨çš„å›¾ç‰‡ã€‚ï¼ˆç”±äºå›¾ç‰‡çš„ä»£ç å®åœ¨å¤ªé•¿å¤ªå¤§äº†ï¼Œä¸å¾—å·²åˆ é™¤ã€‚è‹¥ç¡®å®éœ€è¦ï¼Œç‚¹å‡»é¡µå°¾å¤„"è·å–æ›´æ–°â€è·³è½¬é“¾æ¥è·å–ã€‚ï¼‰
			</div>
		</div>
		<div class="tooltip-container">
			<button>V4.0æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				é‡è¦æ›´æ–°ï¼šè¯¥æºç è·å–äº†MIT Licenseå¼€æºè®¸å¯
			</div>
		</div>
		<div class="tooltip-container">
			<button>V4.1æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.ä¿®å¤äº†ã€æ¡ƒå›­ç»“ä¹‰ã€‘å¯ä»¥è®©æ¡ƒçš„å¯ä½¿ç”¨æ¬¡æ•°ä¸º-1çš„bug<br />
				2.ä¿®å¤äº†æ˜¾ç¤ºAESå±•å¼€æ—¶æŒ‰é’®æ˜¾ç¤ºä¸å®Œå…¨çš„bug<br />
				3.å°†é”¦å›Šç‰Œç»†åˆ†ä¸ºæ™®é€šé”¦å›Šç‰Œå’Œå»¶æ—¶é”¦å›Šç‰Œæ–¹ä¾¿æ—¥åçš„æ›´æ–°<br />
				4.ä¼˜åŒ–äº†è‹¥æµè§ˆå™¨çª—å£è¿‡å°æ—¶ï¼Œä¼šé®æŒ¡éƒ¨åˆ†å†…å®¹çš„æƒ…å†µ<br />
				5.åˆ é™¤äº†æ—§çš„è„šæ°”å¡è®¡æ•°å™¨æ˜¾ç¤ºï¼ˆå³V4.0å‰æ ‡æ˜åˆ é™¤å°±è·‘ä¸äº†çš„éƒ¨åˆ†ï¼‰<br />
				6.ä¼˜åŒ–äº†ä¸€äº›ä»£ç ç»†èŠ‚ï¼Œå¢å¼ºä»£ç çš„å¯è¯»æ€§<br />
				7.å¢åŠ äº†åä¸‡æ¬¡éšæœºæ´—ç‰Œçš„åŠŸèƒ½ï¼Œä»¥åŠæœ‰è¯¸è‘›è¿å¼©çš„æ¦‚ç‡æç¤º
			</div>
		</div>
		<div class="tooltip-container">
			<button>V4.2æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.1ï¼šæ–°å¢æ´—ç‰Œå‡åŒ€æ€§æµ‹è¯•çª—å£é‡æ–°æµ‹è¯•æŒ‰é’®<br />
				1.2ï¼šå®Œå–„æ´—ç‰Œå‡åŒ€æ€§æµ‹è¯•çª—å£çš„è®¡ç®—å…¬å¼<br />
				1.3ï¼šä¼˜åŒ–äº†æ´—ç‰Œå‡åŒ€æ€§æµ‹è¯•çª—å£çš„æ’åº<br />
				2.é‡æ–°é’ˆå¯¹ç§»åŠ¨ç«¯è¿›è¡Œä¸€æ¬¡cssæ ·å¼ä¼˜åŒ–<br />
				3.ä¿®å¤äº†æœ€å·¦è¾¹çš„æ›´æ–°ä¿¡æ¯æŒ‰é’®å¼¹çª—å†…å®¹ä¼šè¢«é®æŒ¡çš„é—®é¢˜<br />
				4.ä¿®å¤äº†ã€å€Ÿåˆ€æ€äººã€‘çš„ä¸€äº›bug
			</div>
		</div>
		<div class="tooltip-container">
			<button>V5.0æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æœ¬æ¨¡æ‹Ÿå™¨ä»¥è„±ç¦»æœ¬åœ°åŒ–æ¨¡å¼ï¼Œæ¥å…¥GitHub Pagesé™æ€ç½‘é¡µæ‰˜ç®¡åŠŸèƒ½,é¡µå°¾å¤„æœ‰å¯¹åº”è·³è½¬é“¾æ¥<br />
				2.ä¿®å¤äº†ç‚¹å‡»éâ€œæ·»åŠ æŒ‡å®šç‰Œâ€ä½†æ˜¯å¼¹å‡ºå¯¹åº”å¼¹å‡ºçš„bug
			</div>
		</div>
		<div class="tooltip-container">
			<button>V5.1æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.æ–°å¢ã€é¡ºæ‰‹ç‰µç¾Šã€‘çš„ä½œç”¨ï¼šé¢å¤–æ‘¸ä¸€å¼ ç‰Œ<br />
				2.æ–°å¢GitCodeæŒ‰é’®ï¼ˆæ‡’å¾—è°ƒæ•™cssç‰ˆï¼‰<br />
				3.åŒæ­¥ä¼˜åŒ–ç‰Œå †æ•°ç»„
			</div>
		</div>
		<div class="tooltip-container">
			<button>V5.2æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.åŒæ­¥è”æœºç‰ˆå¡ç‰Œã€ä¹ä¸æ€èœ€ã€‘ã€ã€å…µç²®å¯¸æ–­ã€‘ã€ã€é—ªç”µã€‘çš„ä½œç”¨
			</div>
		</div>
		<div class="tooltip-container">
			<button>V5.3æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.åŒæ­¥è”æœºç‰ˆä¿®å¤å¡ç‰Œã€äº”è°·ä¸°ç™»ã€‘çš„é—®é¢˜
			</div>
		</div>
		<div class="tooltip-container">
			<button>V5.4æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.åŒæ­¥è”æœºç‰ˆV6.3.0.54ç‰ˆæœ¬çš„æ‰€æœ‰å†…å®¹
			</div>
		</div>
		<div class="tooltip-container">
			<button>V5.5æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.åŒæ­¥è”æœºç‰ˆV6.4.0.55ç‰ˆæœ¬çš„æ‰€æœ‰å†…å®¹
			</div>
		</div>
		<div class="tooltip-container">
			<button>V5.6æ›´æ–°å†…å®¹</button>
			<div class="tooltip">
				1.åŒæ­¥è”æœºç‰ˆV6.5.0.56ç‰ˆæœ¬çš„æ‰€æœ‰å†…å®¹
			</div>
		</div>
		<p>è¯´æ˜ï¼šæœ¬ä»£ç çš„ç‰Œå †æ˜¯çœŸæ­£çš„çº¯éšæœºï¼Œä¸“æ²»å„ç§å˜´ç¡¬<br />
			è¯·å…ˆæŸ¥çœ‹å‰©ä½™ç‰Œå †ï¼Œå†ç‚¹é«˜äº®akã€‚<br />
			ç”±äºæ˜¯çº¯éšæœºåºåˆ—ï¼Œæœ‰ä¸€å¤§å †æ€é—ªæ‰å †å±äºæ­£å¸¸ç°è±¡ï¼ˆæ­å–œä½ åˆ·åˆ°äº†æ²™æ‘©æŸ¯çš„ç‰Œå †ï¼ˆbushiï¼‰ï¼‰ï¼Œä¸æƒ³çœ‹åˆ°æ­¤ç±»æƒ…å†µçš„ï¼Œé‡æ–°æ´—ç‰Œå³å¯<br />
			åˆ·æ–°æŒ‰é’®å¯åœ¨ç½‘é¡µæœ‰ä¸å¯é€†çš„bugæ—¶å°†ç½‘é¡µæ¢å¤åˆ°åˆå§‹çŠ¶æ€
		</p>

		<h2>å®‰å…¨æ ¡éªŒåŒºMD5/AESç¼–ç <button id="toggleMD5AES" style="font-size: 12px; padding: 2px 5px;">â–¼ æ”¶èµ·</button></h2>
		<div id="md5aes-container">
			<div class="md5-panel">
				<div class="md5-display">
					<div id="md5Value">******</div>
					<div class="md5-buttons">
						<button id="toggleMD5" class="md5-button">æ˜¾ç¤ºMD5</button>
						<button id="copyMD5" class="md5-button">å¤åˆ¶</button>
					</div>
				</div>
				<p class="md5-caption">è¯¥æ ‡è¯†ç¬¦åŸºäºå½“å‰ç‰Œå †ç”Ÿæˆï¼Œç”¨äºéªŒè¯ç‰Œå †å”¯ä¸€æ€§</p>
				<div class="verify-panel">
					<input type="text" id="verifyMD5" placeholder="è¾“å…¥MD5éªŒè¯ç‰Œå †" class="verify-input">
					<button onclick="verifyDeck()" class="md5-button">éªŒè¯</button>
					<span id="verifyResult" class="verify-result"></span>
				</div>
			</div>
			<div class="aes-panel">
				<div class="md5-display">
					<div id="aesValue" class="aes-value">******</div>
					<div class="md5-buttons">
						<button id="toggleAES" class="md5-button">æ˜¾ç¤ºAES</button>
						<button id="copyAES" class="md5-button">å¤åˆ¶</button>
					</div>
				</div>
				<p class="aes-caption">åŒ…å«å¯†é’¥çš„AESç¼–ç ï¼Œå¯åå‘è§£æç‰Œå †</p>
				<div class="verify-panel">
					<input type="text" id="verifyAES" placeholder="è¾“å…¥AESç¼–ç éªŒè¯ç‰Œå †" class="verify-input">
					<button onclick="verifyAESDeck()" class="md5-button">è§£å¯†éªŒè¯</button>
					<span id="verifyAESResult" class="verify-result"></span>
				</div>
				<div class="log-panel">
					<button id="exportLog" class="md5-button log-button">
						ğŸ“„ ç”Ÿæˆå®‰å…¨æ—¥å¿—æ–‡ä»¶
					</button>
				</div>
			</div>
		</div>
		<h2>è®°ç‰Œå™¨ <button id="toggleCounter" style="font-size: 12px; padding: 2px 5px;">â–¼ æ”¶èµ·</button></h2>
		<div id="remaining-counts"></div>
		<h3>
			çŠ¶æ€ä¿¡æ¯
			<button id="toggleStatusArea" style="font-size: 12px; padding: 2px 5px;">â–¼ æ”¶èµ·</button>
		</h3>
		<div id="status-area">
			<div id="damage-counter">
				<div id="total-damage">æ€»ä¼¤å®³: 0</div>
				<div id="turn-damage">å½“å‰å›åˆä¼¤å®³: 0</div>
			</div>
			<div id="kill-counter">æ€å¯ç”¨æ¬¡æ•°ï¼š2ï¼Œæœ¬å›åˆå·²ä½¿ç”¨æ€çš„ä¸ªæ•°ï¼š0</div>
			<div id="zhuge-status">è¯¸è‘›è¿å¼©ï¼šæœªè£…å¤‡</div>
			<div id="peach-counter">æ¡ƒå¯ç”¨æ¬¡æ•°ï¼š1</div>
			<div id="wine-counter">é…’å¯ç”¨æ¬¡æ•°ï¼š1</div>
			<div id="delay-area">
				<div class="delay-section">
					<h4>å…µç²®å¯¸æ–­</h4>
					<div id="bingliang-container" class="delay-cards"></div>
				</div>
				<div class="delay-section">
					<h4>ä¹ä¸æ€èœ€</h4>
					<div id="lebu-container" class="delay-cards"></div>
				</div>
				<div class="delay-section">
					<h4>é—ªç”µ</h4>
					<div id="shandian-container" class="delay-cards"></div>
				</div>
			</div>
		</div>

		<div id="testProgress" style="display:none;">
			<progress value="0" max="100"></progress>
			<span>0%</span>
		</div>
		<div id="deck"></div>
		<div id="remaining"></div>
		<div id="hand"></div>
		<!-- æ–°å¢çš„æ•´ç†æ‰‹ç‰ŒæŒ‰é’® -->
		<div style="margin-top: 15px; text-align: center;">
		    <button id="organizeHandBtn"
		        style="padding: 10px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; font-size: 16px;">
		        æ•´ç†æ‰‹ç‰Œ
		    </button>
		    <p style="font-size: 12px; color: #666; margin-top: 5px;">
		        æ’åºé¡ºåºï¼šè¯¸è‘›è¿å¼©â†’æ€â†’é…’â†’é”¦å›Šç‰Œâ†’è£…å¤‡ç‰Œï¼ˆé™¤è¯¸è‘›è¿å¼©å¤–ï¼‰â†’æ¡ƒâ†’é—ªâ†’æ— æ‡ˆå¯å‡»(æœ‰3ç§’å†·å´)
		    </p>
		</div>
		<h3>æ“ä½œæ—¥å¿—</h3>
		<div id="log-container">
			<div id="log"></div>
		</div>
		<div id="stageInfo" class="phase"></div>
		<script>
			const cardCategories = {
				basic: ["æ€", "é—ª", "æ¡ƒ", "é…’", "ç«æ€", "é›·æ€"],
				trick: ["å†³æ–—", "æ— ä¸­ç”Ÿæœ‰", "è¿‡æ²³æ‹†æ¡¥", "é¡ºæ‰‹ç‰µç¾Š", "å€Ÿåˆ€æ€äºº", "å—è›®å…¥ä¾µ", "ä¸‡ç®­é½å‘", "æ¡ƒå›­ç»“ä¹‰", "äº”è°·ä¸°ç™»", "æ— æ‡ˆå¯å‡»", "ç«æ”»", "é“ç´¢è¿ç¯", ],
				ystrick: ["ä¹ä¸æ€èœ€", "é—ªç”µ", "å…µç²®å¯¸æ–­"],
				weapon: ["è¯¸è‘›è¿å¼©", "é›Œé›„åŒè‚¡å‰‘", "é’é¾™åƒæœˆåˆ€", "é’é‡­å‰‘", "ä¸ˆå…«è›‡çŸ›", "éº’éºŸå¼“", "è´¯çŸ³æ–§", "æ–¹å¤©ç”»æˆŸ", "å¯’å†°å‰‘", "å¤é”­åˆ€", "æœ±é›€ç¾½æ‰‡"],
				armor: ["å…«å¦é˜µ", "ä»ç‹ç›¾", "è—¤ç”²", "ç™½é“¶ç‹®å­"],
				horse: ["èµ¤å…”", "å¤§å®›", "ç´«éª", "çš„å¢", "ç»å½±", "çˆªé»„é£ç”µ", "éª…éª"]
			};
			const standardDeck = [{
					name: "æ€",
					suits: ["â™ ï¸7", "â™¥ï¸J", "â™£ï¸2", "â™£ï¸3", "â™£ï¸4", "â™£ï¸5", "â™£ï¸6", "â™£ï¸7", "â™¦ï¸6", "â™¦ï¸7", "â™¦ï¸8", "â™¦ï¸9", "â™¦ï¸10",
						"â™¦ï¸K"
					],
					count: 1
				},
				{
					name: "æ€",
					suits: ["â™ ï¸8", "â™ ï¸9", "â™ ï¸10", "â™¥ï¸10", "â™£ï¸8", "â™£ï¸9", "â™£ï¸10", "â™£ï¸J"],
					count: 2
				},
				{
					name: "ç«æ€",
					suits: ["â™¥ï¸4", "â™¥ï¸7", "â™¥ï¸10", "â™¦ï¸4", "â™¦ï¸5"],
					count: 1
				},
				{
					name: "é›·æ€",
					suits: ["â™ ï¸4", "â™ ï¸5", "â™ ï¸6", "â™ ï¸7", "â™ ï¸8", "â™£ï¸5", "â™£ï¸6", "â™£ï¸7", "â™£ï¸8"],
					count: 1
				},
				{
					"name": "é—ª",
					"suits": ["â™¥ï¸2", "â™¦ï¸2", "â™¦ï¸6", "â™¦ï¸7", "â™¦ï¸8", "â™¦ï¸10"],
					"count": 2
				},
				{
					"name": "é—ª",
					"suits": ["â™¥ï¸8", "â™¥ï¸9", "â™¥ï¸J", "â™¥ï¸Q", "â™¥ï¸K", "â™¦ï¸3", "â™¦ï¸4", "â™¦ï¸5", "â™¦ï¸9"],
					"count": 1
				},
				{
					"name": "é—ª",
					"suits": ["â™¦ï¸J"],
					"count": 3
				},
				{
					name: "æ¡ƒ",
					suits: ["â™¥ï¸3", "â™¥ï¸4", "â™¥ï¸5", "â™¥ï¸7", "â™¥ï¸8", "â™¥ï¸9", "â™¥ï¸Q", "â™¦ï¸2", "â™¦ï¸3", "â™¦ï¸Q"],
					count: 1
				},
				{
					name: "æ¡ƒ",
					suits: ["â™¥ï¸6"],
					count: 2
				},
				{
					name: "é…’",
					suits: ["â™ ï¸3", "â™ ï¸9", "â™£ï¸3", "â™£ï¸9", "â™¦ï¸9"],
					count: 1
				},
				{
					name: "å†³æ–—",
					suits: ["â™ ï¸A", "â™£ï¸A", "â™¦ï¸A"],
					count: 1
				},
				{
					name: "æ— ä¸­ç”Ÿæœ‰",
					suits: ["â™¥ï¸7", "â™¥ï¸8", "â™¥ï¸9", "â™¥ï¸J"],
					count: 1
				},
				{
					name: "è¿‡æ²³æ‹†æ¡¥",
					suits: ["â™ ï¸3", "â™ ï¸4", "â™ ï¸Q", "â™¥ï¸Q", "â™£ï¸3", "â™£ï¸4"],
					count: 1
				},
				{
					name: "é¡ºæ‰‹ç‰µç¾Š",
					suits: ["â™ ï¸3", "â™ ï¸4", "â™ ï¸J", "â™¦ï¸3", "â™¦ï¸4"],
					count: 1
				},
				{
					name: "å€Ÿåˆ€æ€äºº",
					suits: ["â™£ï¸Q", "â™£ï¸K"],
					count: 1
				},
				{
					name: "å—è›®å…¥ä¾µ",
					suits: ["â™ ï¸7", "â™ ï¸K", "â™£ï¸7"],
					count: 1
				},
				{
					name: "ä¸‡ç®­é½å‘",
					suits: ["â™¥ï¸A"],
					count: 1
				},
				{
					name: "æ¡ƒå›­ç»“ä¹‰",
					suits: ["â™¥ï¸A"],
					count: 1
				},
				{
					name: "äº”è°·ä¸°ç™»",
					suits: ["â™¥ï¸3", "â™¥ï¸4"],
					count: 1
				},
				{
					name: "æ— æ‡ˆå¯å‡»",
					suits: ["â™ ï¸J", "â™£ï¸Q", "â™£ï¸K", "â™¦ï¸Q", "â™ ï¸K", "â™¥ï¸A", "â™¥ï¸K"],
					count: 1
				},
				{
					name: "ç«æ”»",
					suits: ["â™¥ï¸2", "â™¥ï¸3", "â™¦ï¸Q"],
					count: 1
				},
				{
					name: "é“ç´¢è¿ç¯",
					suits: ["â™ ï¸J", "â™ ï¸Q", "â™£ï¸10", "â™£ï¸J", "â™£ï¸Q", "â™£ï¸K"],
					count: 1
				},
				{
					name: "ä¹ä¸æ€èœ€",
					suits: ["â™ ï¸6", "â™¥ï¸6", "â™£ï¸6"],
					count: 1
				},
				{
					name: "é—ªç”µ",
					suits: ["â™ ï¸A", "â™¥ï¸Q"],
					count: 1
				},
				{
					name: "å…µç²®å¯¸æ–­",
					suits: ["â™ ï¸10", "â™£ï¸4"],
					count: 1
				},
				{
					name: "é›Œé›„åŒè‚¡å‰‘",
					suits: ["â™ ï¸2"],
					count: 1
				},
				{
					name: "é’é¾™åƒæœˆåˆ€",
					suits: ["â™ ï¸5"],
					count: 1
				},
				{
					name: "é’é‡­å‰‘",
					suits: ["â™ ï¸6"],
					count: 1
				},
				{
					name: "ä¸ˆå…«è›‡çŸ›",
					suits: ["â™ ï¸Q"],
					count: 1
				},
				{
					name: "éº’éºŸå¼“",
					suits: ["â™¥ï¸5"],
					count: 1
				},
				{
					name: "è¯¸è‘›è¿å¼©",
					suits: ["â™£ï¸A", "â™¦ï¸A"],
					count: 1
				},
				{
					name: "è´¯çŸ³æ–§",
					suits: ["â™¦ï¸5"],
					count: 1
				},
				{
					name: "æ–¹å¤©ç”»æˆŸ",
					suits: ["â™¦ï¸Q"],
					count: 1
				},
				{
					name: "å¯’å†°å‰‘",
					suits: ["â™ ï¸2"],
					count: 1
				},
				{
					name: "å¤é”­åˆ€",
					suits: ["â™ ï¸A"],
					count: 1
				},
				{
					name: "æœ±é›€ç¾½æ‰‡",
					suits: ["â™¦ï¸A"],
					count: 1
				},
				{
					name: "å…«å¦é˜µ",
					suits: ["â™ ï¸2", "â™£ï¸2"],
					count: 1
				},
				{
					name: "ä»ç‹ç›¾",
					suits: ["â™£ï¸2"],
					count: 1
				},
				{
					name: "è—¤ç”²",
					suits: ["â™ ï¸2", "â™£ï¸2"],
					count: 1
				},
				{
					name: "ç™½é“¶ç‹®å­",
					suits: ["â™£ï¸A"],
					count: 1
				},
				{
					name: "èµ¤å…”",
					suits: ["â™¥ï¸5"],
					count: 1
				},
				{
					name: "å¤§å®›",
					suits: ["â™ ï¸K"],
					count: 1
				},
				{
					name: "ç´«éª",
					suits: ["â™¦ï¸K"],
					count: 1
				},
				{
					name: "çš„å¢",
					suits: ["â™£ï¸5"],
					count: 1
				},
				{
					name: "ç»å½±",
					suits: ["â™ ï¸5"],
					count: 1
				},
				{
					name: "çˆªé»„é£ç”µ",
					suits: ["â™¥ï¸K"],
					count: 1
				},
				{
					name: "éª…éª",
					suits: ["â™¦ï¸K"],
					count: 1
				},
			];
			let deck = [];
			let drawnCards = [];
			let discardPile = [];
			let hand = [];
			let phase = '';
			let lastUsedCard = null;
			let reshuffleUsed = 0;
			const MAX_RESHUFLE = 7;
			let currentMD5 = '';
			let showMD5 = false;
			let currentAES = '';
			let showAES = false;
			let originalDeck = [];
			let isCounterCollapsed = false;
			let isMD5AESCollapsed = false;
			let killCount = 2;
			let hasZhugeLianNu = false;
			let currentWeapon = null;
			let peachCount = 1;
			let wineCount = 1;
			// å»¶æ—¶é”¦å›ŠåŒºåŸŸ
			let bingliangArea = []; // å…µç²®å¯¸æ–­å­˜æ”¾åŒº
			let lebuArea = []; // ä¹ä¸æ€èœ€å­˜æ”¾åŒº
			let shandianArea = []; // é—ªç”µå­˜æ”¾åŒº
			const MAX_DELAY_CARDS = 2; // æ™®é€šå»¶æ—¶é”¦å›Šä¸Šé™
			const MAX_SHANDIAN = 1; // é—ªç”µä¸Šé™
			let totalDamage = 0; // æ€»ä¼¤å®³è®¡æ•°å™¨
			let currentTurnDamage = 0; // å½“å‰å›åˆä¼¤å®³è®¡æ•°å™¨
			let wineEffect = false; // é…’æ•ˆæœæ ‡è®°ï¼ˆä¸‹ä¸€å¼ æ€ä¼¤å®³+1ï¼‰
			let usedKillCount = 0; // æœ¬å›åˆå·²ä½¿ç”¨æ€çš„æ¬¡æ•°

			function initializeDeck() {
				document.getElementById('log').innerHTML = '';
				log("ç‰Œå †åˆå§‹åŒ–å¼€å§‹");
				deck = [];
				drawnCards = [];
				discardPile = [];
				hand = [];
				document.getElementById('deck').innerHTML = '';
				reshuffleUsed = 0;
				phase = '';
				lastUsedCard = null;
				peachCount = 1;
				wineCount = 1;
				// é‡ç½®å»¶æ—¶é”¦å›ŠåŒº
				bingliangArea = [];
				lebuArea = [];
				shandianArea = [];
				// é‡ç½®ä¼¤å®³è®¡æ•°å™¨
				totalDamage = 0;
				currentTurnDamage = 0;
				wineEffect = false;
				standardDeck.forEach(card => {
					card.suits.forEach(suitStr => {
						const match = suitStr.match(/^([â™ â™¥â™£â™¦]ï¸?)([JQKA]|\d+)$/);
						if (match) {
							const suitPart = match[1];
							let point = match[2];
							switch (point) {
								case 'J':
									point = 11;
									break;
								case 'Q':
									point = 12;
									break;
								case 'K':
									point = 13;
									break;
								case 'A':
									point = 1;
									break;
								default:
									point = parseInt(point, 10);
							}
							for (let i = 0; i < card.count; i++) {
								deck.push({
									name: card.name,
									suit: suitPart,
									point: point,
									uid: CryptoJS.lib.WordArray.random(16).toString()
								});
							}
						}

					});
				});
				currentWeapon = null;
				killCount = 2;
				hasZhugeLianNu = false;
				updateStatus();
				shuffleDeck();
				generateDeckMD5();
				updateMD5Display();
				generateDeckAES();
				updateAESDisplay();
				updateRemaining();
				startGame();
				log("ç‰Œå †åˆå§‹åŒ–å®Œæˆ");
			}

			function getPointDisplay(point) {
				switch (point) {
					case 11:
						return 'J';
					case 12:
						return 'Q';
					case 13:
						return 'K';
					case 1:
						return 'A';
					default:
						return point;
				}
			}

			function generateDeckMD5() {
				const deckString = deck
					.sort((a, b) => a.uid.localeCompare(b.uid))
					.map(c => `${c.name}|${c.suit}|${c.point}|${c.uid}`)
					.join('@@');
				const firstHash = CryptoJS.MD5(deckString).toString();
				const timestamp = Date.now().toString(16).padStart(16, '0');
				currentMD5 = CryptoJS.MD5(firstHash + timestamp).toString();
				const isDebug = new URLSearchParams(window.location.search).has('debug');
				currentMD5 = isDebug ? firstHash : CryptoJS.MD5(firstHash + timestamp).toString();
				if (isDebug) console.log("è°ƒè¯•æ¨¡å¼MD5ï¼ˆä¸å«æ—¶é—´æˆ³ï¼‰:", currentMD5);
			}
			const deckSnapshots = {};

			function saveSnapshot() {
				const snapshot = {
					deck: deck.map(c => ({
						...c
					})),
					md5: currentMD5,
					timestamp: Date.now()
				};
				deckSnapshots[currentMD5] = snapshot;
				localStorage.setItem('md5Snapshots', JSON.stringify(deckSnapshots));
				log(`ç‰Œå †å¿«ç…§å·²ä¿å­˜ (MD5: ${currentMD5})`);
			}

			function loadSnapshot(targetMD5) {
				const snapshot = deckSnapshots[targetMD5];
				if (!snapshot) return alert("æ— æ­¤ç‰Œå †è®°å½•");
				deck = snapshot.deck;
				currentMD5 = snapshot.md5;
				updateUI();
				log(`å·²åŠ è½½ç‰Œå †å¿«ç…§ (MD5: ${targetMD5})`);
			}

			function updateMD5Display() {
				const display = document.getElementById('md5Value');
				if (showMD5) {
					const formatted = currentMD5
						.match(/.{1,4}/g)
						.join('-')
						.toUpperCase();
					display.textContent = formatted;
					display.style.color = '#2196F3';
				} else {
					display.textContent = '******';
					display.style.color = '#666';
				}
			}
			document.getElementById('toggleMD5').addEventListener('click', () => {
				showMD5 = !showMD5;
				document.getElementById('toggleMD5').textContent =
					showMD5 ? 'éšè—MD5' : 'æ˜¾ç¤ºMD5';
				updateMD5Display();
			});
			document.getElementById('copyMD5').addEventListener('click', () => {
				if (!currentMD5) return;
				const copy = async () => {
					try {
						await navigator.clipboard.writeText(currentMD5);
						document.getElementById('copyMD5').classList.add('copied');
						setTimeout(() => {
							document.getElementById('copyMD5').classList.remove('copied');
						}, 1000);
						log('MD5å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
					} catch (err) {
						const textarea = document.createElement('textarea');
						textarea.value = currentMD5;
						document.body.appendChild(textarea);
						textarea.select();
						document.execCommand('copy');
						document.body.removeChild(textarea);
						log('MD5å·²å¤åˆ¶ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰');
					}
				};
				copy().catch(err => {
					console.error('å¤åˆ¶å¤±è´¥:', err);
					log('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¤åˆ¶');
				});
			});

			function verifyDeck() {
				const inputMD5 = document.getElementById('verifyMD5').value.replace(/-/g, '').toLowerCase();
				const isValid = currentMD5 === inputMD5;
				const resultSpan = document.getElementById('verifyResult');
				resultSpan.textContent = isValid ? 'âœ… éªŒè¯é€šè¿‡' : 'âŒ éªŒè¯å¤±è´¥';
				resultSpan.style.color = isValid ? '#4CAF50' : '#f44336';
				log(`ç‰Œå †MD5éªŒè¯${isValid ? 'æˆåŠŸ' : 'å¤±è´¥'}`);
			}

			function generateDeckAES() {
				try {
					const deckData = deck.map(c => ({
						n: c.name,
						s: c.suit,
						p: c.point,
						u: c.uid
					}));
					const key = CryptoJS.lib.WordArray.random(128 / 8);
					const iv = CryptoJS.lib.WordArray.random(128 / 8);
					const encrypted = CryptoJS.AES.encrypt(
						JSON.stringify(deckData),
						key, {
							iv: iv
						}
					);
					currentAES = [
						key.toString(CryptoJS.enc.Base64),
						iv.toString(CryptoJS.enc.Base64),
						encrypted.toString()
					].join('::');
				} catch (e) {
					console.error('AESç”Ÿæˆå¤±è´¥:', e);
					currentAES = 'ERROR';
				}
			}

			function updateAESDisplay() {
				const display = document.getElementById('aesValue');
				if (!display) return;
				if (showAES) {
					const formatted = currentAES
						.match(/.{1,24}/g)
						.join('\n');
					display.textContent = formatted;
					display.style.color = '#2196F3';
				} else {
					display.textContent = '******';
					display.style.color = '#666';
				}
			}
			document.getElementById('toggleAES').addEventListener('click', () => {
				showAES = !showAES;
				document.getElementById('toggleAES').textContent =
					showAES ? 'éšè—AES' : 'æ˜¾ç¤ºAES';
				updateAESDisplay();
			});
			document.getElementById('copyAES').addEventListener('click', () => {
				if (!currentAES || currentAES === '******') return;
				const copy = async () => {
					try {
						await navigator.clipboard.writeText(currentAES);
						document.getElementById('copyAES').classList.add('copied');
						setTimeout(() => {
							document.getElementById('copyAES').classList.remove('copied');
						}, 1000);
						log('AESç¼–ç å·²å¤åˆ¶');
					} catch (err) {
						const textarea = document.createElement('textarea');
						textarea.value = currentAES;
						document.body.appendChild(textarea);
						textarea.select();
						document.execCommand('copy');
						document.body.removeChild(textarea);
						log('AESç¼–ç å·²å¤åˆ¶ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰');
					}
				};
				copy().catch(err => {
					console.error('å¤åˆ¶å¤±è´¥:', err);
					log('AESå¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¤åˆ¶');
				});
			});

			function verifyAESDeck() {
				const input = document.getElementById('verifyAES').value.trim();
				const resultSpan = document.getElementById('verifyAESResult');
				if (!input) {
					resultSpan.textContent = 'âŒ è¯·è¾“å…¥ç¼–ç ';
					resultSpan.style.color = '#f44336';
					return;
				}
				try {
					const [keyB64, ivB64, data] = input.split('::');
					if (!keyB64 || !ivB64 || !data) throw new Error('æ ¼å¼æ— æ•ˆ');
					const key = CryptoJS.enc.Base64.parse(keyB64);
					const iv = CryptoJS.enc.Base64.parse(ivB64);
					const decrypted = CryptoJS.AES.decrypt(data, key, {
						iv: iv
					});
					const utf8String = decrypted.toString(CryptoJS.enc.Utf8);
					if (!utf8String) throw new Error('è§£å¯†å¤±è´¥');
					const decoded = JSON.parse(utf8String);
					deck = decoded.map(c => ({
						name: c.n,
						suit: c.s,
						point: c.p,
						uid: c.u
					}));
					generateDeckMD5();
					updateMD5Display();
					updateRemaining();
					revealDeck();
					log('AESè§£ç æˆåŠŸï¼Œç‰Œå †å·²åŠ è½½');
					resultSpan.textContent = 'âœ… éªŒè¯é€šè¿‡';
					resultSpan.style.color = '#4CAF50';
				} catch (e) {
					console.error('AESéªŒè¯å¤±è´¥:', e);
					resultSpan.textContent = 'âŒ æ— æ•ˆç¼–ç ';
					resultSpan.style.color = '#f44336';
					log('AESè§£ç å¤±è´¥: ' + e.message);
				}
			}

			// æ›´æ–°å»¶æ—¶é”¦å›ŠåŒºåŸŸæ˜¾ç¤º
			function updateDelayArea() {
				const bingliangContainer = document.getElementById('bingliang-container');
				const lebuContainer = document.getElementById('lebu-container');
				const shandianContainer = document.getElementById('shandian-container');

				// æ¸…ç©ºå®¹å™¨
				bingliangContainer.innerHTML = '';
				lebuContainer.innerHTML = '';
				shandianContainer.innerHTML = '';

				// å…µç²®å¯¸æ–­åŒºåŸŸ
				if (bingliangArea.length === 0) {
					bingliangContainer.innerHTML = '<div class="delay-card disabled">ç©º</div>';
				} else {
					bingliangArea.forEach(card => {
						const cardDiv = document.createElement('div');
						cardDiv.className = 'delay-card';
						cardDiv.textContent = `${card.name} ${card.suit}${getPointDisplay(card.point)}`;
						bingliangContainer.appendChild(cardDiv);
					});
				}

				// ä¹ä¸æ€èœ€åŒºåŸŸ
				if (lebuArea.length === 0) {
					lebuContainer.innerHTML = '<div class="delay-card disabled">ç©º</div>';
				} else {
					lebuArea.forEach(card => {
						const cardDiv = document.createElement('div');
						cardDiv.className = 'delay-card';
						cardDiv.textContent = `${card.name} ${card.suit}${getPointDisplay(card.point)}`;
						lebuContainer.appendChild(cardDiv);
					});
				}

				// é—ªç”µåŒºåŸŸ
				if (shandianArea.length === 0) {
					shandianContainer.innerHTML = '<div class="delay-card disabled">ç©º</div>';
				} else {
					shandianArea.forEach(card => {
						const cardDiv = document.createElement('div');
						cardDiv.className = 'delay-card';
						cardDiv.textContent = `${card.name} ${card.suit}${getPointDisplay(card.point)}`;
						shandianContainer.appendChild(cardDiv);
					});
				}
			}

			function getSecureRandomIndex(max) {
				if (window.crypto && typeof window.crypto.getRandomValues === 'function') {
					const randomBuffer = new Uint32Array(1);
					window.crypto.getRandomValues(randomBuffer);
					return randomBuffer[0] % (max + 1);
				} else {
					return Math.floor(Math.random() * (max + 1));
				}
			}
			async function testShuffleUniformity() {
				const CONFIG = {
					TOTAL_TRIALS: 100000,
					BATCH_SIZE: 5000,
					DECK_SIZE: 160,
					AK_COUNT: 2,
					CHECK_SIZE: 7
				};
				const backdrop = document.createElement('div');
				backdrop.style.cssText = `
			        position: fixed;
			        top: 0;
			        left: 0;
			        right: 0;
			        bottom: 0;
			        background: rgba(0,0,0,0.5);
			        z-index: 9998;
			        backdrop-filter: blur(3px);
			    `;
				const panel = document.createElement('div');
				panel.className = 'scrollable-panel';
				panel.style.cssText = `
				    position: fixed;
				    top: 50%;
				    left: 50%;
				    transform: translate(-50%, -50%);
				    background: white;
				    padding: 25px;
				    border-radius: 12px;
				    box-shadow: 0 4px 20px rgba(0,0,0,0.25);
				    z-index: 9999;
				    width: 80%;
				    max-width: 800px;
				    max-height: 90vh;        // å…³é”®å±æ€§1ï¼šé™åˆ¶æœ€å¤§é«˜åº¦
				    overflow-y: auto;         // å…³é”®å±æ€§2ï¼šå¯ç”¨å‚ç›´æ»šåŠ¨
				    font-family: Arial, sans-serif;
				`;
				panel.innerHTML = `
			        <div style="position: relative; margin-bottom: 20px;">
			            <h2 style="margin:0 0 10px; color:#333; font-size:20px;">æ´—ç‰Œå‡åŒ€æ€§æµ‹è¯•</h2>
			            <div style="position: absolute; top: -15px; right: -15px; display: flex; gap: 5px;">
			                <button id="rerunTest" 
			                    style="padding: 8px 20px;
			                           background: #4CAF50;
			                           color: white;
			                           border: none;
			                           border-radius: 4px;
			                           cursor: pointer;">
			                    é‡æ–°æµ‹è¯• â–¶
			                </button>
			                <button id="closePanel" 
			                    style="padding: 8px 20px;
			                           background: #f44336;
			                           color: white;
			                           border: none;
			                           border-radius: 4px;
			                           cursor: pointer;">
			                    å…³é—­çª—å£ Ã—
			                </button>
			            </div>
			        </div>
			        <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:15px;">
			            <div>
			                <h3 style="font-size:14px; color:#666; margin:0 0 8px;">å®é™…ç»“æœ</h3>
			                <p>â‰¥1å¼ AKï¼š <span id="actualSingle">0</span></p>
			                <p>â‰¥2å¼ AKï¼š <span id="actualDouble">0</span></p>
			            </div>
			            <div>
			                <h3 style="font-size:14px; color:#666; margin:0 0 8px;">ç†è®ºå‚è€ƒ</h3>
			                <p>â‰ˆ8.51% (å•AK)</p>
			                <p>â‰ˆ0.165% (åŒAK)</p>
			            </div>
			        </div>
			        <div style="margin-top:20px; padding:15px; background:#f8f9fa; border-radius:6px;">
			            <!-- å•AKè®¡ç®—å…¬å¼ -->
			            <div style="margin-bottom:25px;">
			                <h4 style="color:#444; margin:0 0 8px; font-size:14px;">1. è‡³å°‘1å¼ è¯¸è‘›è¿å¼©ï¼ˆâ‰ˆ8.56%ï¼‰</h4>
			                <div style="font-family:monospace; font-size:14px;">
			                    <p style="margin:6px 0">N=160ï¼ˆæ€»ç‰Œæ•°ï¼‰</p>
			                    <p style="margin:6px 0">K=2ï¼ˆè¯¸è‘›è¿å¼©æ•°é‡ï¼‰</p>
			                    <p style="margin:6px 0">n=7ï¼ˆæŠ½ç‰Œæ•°ï¼‰</p>
			                    <p style="margin:4px 0;">P(â‰¥1) = 1 - [C(158,7) / C(160,7)]</p>
			                    <p style="margin:4px 0; color:#666;">      = 1 - 158ï¼/ ï¼ˆ7ï¼* 151ï¼ï¼‰/ 160ï¼/ï¼ˆ7ï¼ 8 153ï¼ï¼‰</p>
			                    <p style="margin:4px 0; color:#666;">      = 1 - (158Ã—157) / (160Ã—159)</p>
			                    <p style="margin:4px 0; color:#2196F3;">      â‰ˆ 8.51%</p>
			                </div>
			            </div>
			            <!-- åŒAKè®¡ç®—å…¬å¼ -->
			            <div style="margin-bottom:25px;">
			                <h4 style="color:#444; margin:0 0 8px; font-size:14px;">2. è‡³å°‘2å¼ è¯¸è‘›è¿å¼©ï¼ˆâ‰ˆ0.165%ï¼‰</h4>
			                <div style="font-family:monospace; font-size:14px;">
			                    <div style="margin-bottom:8px;">
			                        <p style="margin:4px 0;">è®¡ç®—å…¬å¼</p>
			                        <p style="margin:4px 0;">P (â‰¥2) = C ( K , 2 ) * C( N - K , n - 2) / C(N , n)</p>
			                        <p style="margin:4px 0;">P (=2) = C ( 2 , 2 ) * C( 158 , 5 ) / C (160 , 7)</P>
			                        <p style="margin:4px 0;">       = (1 * 158! / 5! * 153! ) / 160! / 7! * 153!</p>
			                        <p style="margin:4px 0;">P(â‰¥2) = [C(2,2)Â·C(158,5)] / C(160,7)</p>
			                        <p style="margin:4px 0; color:#666;">      = [1 Ã— (158Ã—157Ã—156Ã—155Ã—154)]</p>
			                        <p style="margin:4px 0; color:#666;">      / [160Ã—159Ã—158Ã—157Ã—156Ã—155Ã—154]</p>
			                    </div>
			                    <div style="border-left:3px solid #ddd; padding-left:12px; color:#666;">
			                        <p style="margin:4px 0;">åˆ†å­åŒ–ç®€ï¼š7Ã—6=42</p>
			                        <p style="margin:4px 0;">åˆ†æ¯åŒ–ç®€ï¼š160Ã—159=25,440</p>
			                        <p style="margin:4px 0; color:#2196F3;">æœ€ç»ˆâ‰ˆ42/25,440â‰ˆ0.165%</p>
			                    </div>
			                </div>
			            </div>
			        </div>
			        <progress value="0" max="${CONFIG.TOTAL_TRIALS}" 
			            style="width:100%; height:8px; margin:15px 0;"></progress>
			        <div id="akStats" style="color:#666; font-size:14px;"></div>
			    `;
				document.body.appendChild(panel);
				panel.style.cssText += `
				    ::-webkit-scrollbar {
				        width: 12px;  // å¢åŠ æ»šåŠ¨æ¡å®½åº¦
				    }
				    ::-webkit-scrollbar-track {
				        background: #f1f1f1;
				        border-radius: 10px;
				    }
				    ::-webkit-scrollbar-thumb {
				        background: #4CAF50;  // è®¾ç½®æ»šåŠ¨æ¡é¢œè‰²ä¸ºè“è‰²
				        border-radius: 10px;
				    }
				    ::-webkit-scrollbar-thumb:hover {
				        background: #3e8e41;  // æ»šåŠ¨æ¡æ‚¬åœæ—¶çš„é¢œè‰²
				    }
				`;
				document.body.appendChild(backdrop);
				document.body.appendChild(panel);
				let isClosing = false;
				let stats = {
					single: 0,
					double: 0
				};
				let completed = 0;
				const closePanel = () => {
					if (isClosing) return;
					isClosing = true;
					panel.style.transition = 'opacity 0.3s, transform 0.3s';
					panel.style.opacity = '0';
					panel.style.transform = 'translate(-50%, -50%) scale(0.9)';
					backdrop.style.transition = 'opacity 0.3s';
					backdrop.style.opacity = '0';
					setTimeout(() => {
						document.body.removeChild(backdrop);
						document.body.removeChild(panel);
					}, 300);
				};
				panel.querySelector('#closePanel').addEventListener('click', closePanel);
				panel.querySelector('#rerunTest').addEventListener('click', () => {
					closePanel();
					testShuffleUniformity();
				});
				const generateTestDeck = () =>
					Array.from({
						length: CONFIG.DECK_SIZE
					}, (_, i) => ({
						isAK: i < CONFIG.AK_COUNT,
						id: i
					}));
				const runBatch = async () => {
					for (let i = 0; i < CONFIG.BATCH_SIZE; i++) {
						if (isClosing) return;
						const deck = generateTestDeck();
						for (let j = deck.length - 1; j > 0; j--) {
							const k = Math.floor(Math.random() * (j + 1));
							[deck[j], deck[k]] = [deck[k], deck[j]];
						}
						const akCount = deck.slice(0, CONFIG.CHECK_SIZE)
							.filter(c => c.isAK).length;
						if (akCount >= 1) stats.single++;
						if (akCount >= 2) stats.double++;
					}
					completed += CONFIG.BATCH_SIZE;
					panel.querySelector('progress').value = completed;
					panel.querySelector('#actualSingle').textContent =
						`${stats.single} (${(stats.single / completed * 100).toFixed(2)}%)`;
					panel.querySelector('#actualDouble').textContent =
						`${stats.double} (${(stats.double / completed * 100).toFixed(2)}%)`;
					panel.querySelector('#akStats').innerHTML = `
			            <p>å·²æµ‹è¯•ï¼š${completed.toLocaleString()} æ¬¡</p>
			            <p>å•AKæ¦‚ç‡ï¼š${(stats.single / completed * 100).toFixed(2)}%</p>
			            <p>åŒAKæ¦‚ç‡ï¼š${(stats.double / completed * 100).toFixed(2)}%</p>
			        `;
				};
				try {
					const startTime = performance.now();
					while (completed < CONFIG.TOTAL_TRIALS && !isClosing) {
						await new Promise(resolve =>
							requestAnimationFrame(async () => {
								await runBatch();
								resolve();
							})
						);
					}
					if (!isClosing) {
						const totalTime = ((performance.now() - startTime) / 1000).toFixed(1);
						panel.querySelector('#akStats').innerHTML += `
			                <div style="margin-top:15px; padding-top:15px; border-top:1px solid #eee;">
			                    <p>æ€»è€—æ—¶ï¼š${totalTime} ç§’</p>
			                    <p>æµ‹è¯•ç‰Œå †ï¼š${CONFIG.DECK_SIZE}å¼ ï¼ˆå«${CONFIG.AK_COUNT}AKï¼‰</p>
			                </div>
			            `;
					}
				} catch (error) {
					console.error('æµ‹è¯•å‡ºé”™:', error);
					panel.querySelector('#akStats').innerHTML = `
			            <div style="color: red;">
			                <h3>æµ‹è¯•å¤±è´¥</h3>
			                <p>${error.message}</p>
			            </div>
			        `;
				}
			}

			function showPerformanceWarning() {
				return new Promise((resolve) => {
					const backdrop = document.createElement('div');
					backdrop.style.cssText = `
			            position: fixed;
			            top: 0;
			            left: 0;
			            right: 0;
			            bottom: 0;
			            background: rgba(0,0,0,0.6);
			            z-index: 9999;
			            display: flex;
			            justify-content: center;
			            align-items: center;
			        `;
					const alertBox = document.createElement('div');
					alertBox.style.cssText = `
			            background: white;
			            padding: 25px;
			            border-radius: 12px;
			            min-width: 400px;
			            max-width: 90vw;
			            box-shadow: 0 4px 20px rgba(0,0,0,0.25);
			        `;
					alertBox.innerHTML = `
			            <h2 style="margin:0 0 15px; font-size:20px; color:#d32f2f;">âš ï¸ æ€§èƒ½è­¦å‘Š</h2>
			            <ul style="margin:0 0 20px; padding-left:20px;">
			                <li style="margin-bottom:8px;">CPUä½¿ç”¨ç‡å¯èƒ½è¾¾åˆ°100%</li>
			                <li style="margin-bottom:8px;">æµè§ˆå™¨å¯èƒ½æš‚æ—¶æ— å“åº”ï¼ˆçº¦10-30ç§’ï¼‰</li>
			                <li style="margin-bottom:8px;">ç§»åŠ¨è®¾å¤‡å¯èƒ½å‡ºç°æ˜æ˜¾å‘çƒ­</li>
			            </ul>
			            <div style="display: flex; gap:10px;">
			                <button id="confirmBtn" 
			                    style="flex:1; padding:12px; background:#4CAF50; 
			                           color:white; border:none; border-radius:6px;
			                           cursor:pointer;">ç»§ç»­æ‰§è¡Œ</button>
			                <button id="cancelBtn"
			                    style="flex:1; padding:12px; background:#f44336;
			                           color:white; border:none; border-radius:6px;
			                           cursor:pointer;">å–æ¶ˆæ“ä½œ</button>
			            </div>
			        `;
					const close = (result) => {
						document.body.removeChild(backdrop);
						resolve(result);
					};
					alertBox.querySelector('#confirmBtn').addEventListener('click', () => close(true));
					alertBox.querySelector('#cancelBtn').addEventListener('click', () => close(false));
					backdrop.addEventListener('click', (e) => {
						if (e.target === backdrop) close(false);
					});
					backdrop.appendChild(alertBox);
					document.body.appendChild(backdrop);
				});
			}

			function buildAKStats(total, single, double, totalAK) {
				const singleRate = (single / total * 100).toFixed(2);
				const doubleRate = (double / total * 100).toFixed(2);
				return `<div style="border-top:1px solid #ddd;padding-top:10px;">
			        <h4>è¯¸è‘›è¿å¼©ç»Ÿè®¡ï¼ˆç‰Œå †å…±${totalAK}å¼ ï¼‰</h4>
			        <p>å‰7å¼ å‡ºç°è‡³å°‘1å¼ ï¼š 
			            ${single.toLocaleString()}/${total.toLocaleString()}, 
			            ${singleRate}%</p>
			        <p>å‰7å¼ åŒæ—¶å‡ºç°2å¼ ï¼š 
			            ${double.toLocaleString()}/${total.toLocaleString()}, 
			            ${doubleRate}%</p>
			    </div>`;
			}

			function updateAKStats(progress, completed, single, double) {
				const statsDiv = progress.querySelector('#akStats');
				if (!statsDiv) return;
				const current = completed.toLocaleString();
				const singleRate = (single / completed * 100).toFixed(2);
				const doubleRate = (double / completed * 100).toFixed(2);
				statsDiv.innerHTML = `
			        <p>å®æ—¶ç»Ÿè®¡ï¼ˆå·²æµ‹è¯•${current}æ¬¡ï¼‰:</p>
			        <p>å•AKå‡ºç°ç‡: ${singleRate}%</p>
			        <p>åŒAKå‡ºç°ç‡: ${doubleRate}%</p>`;
			}

			function generateStandardDeck() {
				const deck = [];
				standardDeck.forEach(card => {
					card.suits.forEach(suitStr => {
						const match = suitStr.match(/^([â™ â™¥â™£â™¦]ï¸?)([JQKA]|\d+)$/);
						if (match) {
							const suitPart = match[1];
							let point = match[2];
							switch (point) {
								case 'J':
									point = 11;
									break;
								case 'Q':
									point = 12;
									break;
								case 'K':
									point = 13;
									break;
								case 'A':
									point = 1;
									break;
								default:
									point = parseInt(point, 10);
							}
							for (let i = 0; i < card.count; i++) {
								deck.push({
									name: card.name,
									suit: suitPart,
									point: point,
									uid: CryptoJS.lib.WordArray.random(16).toString()
								});
							}
						}
					});
				});
				return deck;
			}
			async function showPerformanceWarning(testFunction) {
				return new Promise((resolve) => {
					const alertBox = document.createElement('div');
					alertBox.className = 'security-alert';
					alertBox.innerHTML = `
			            <strong>æ€§èƒ½è­¦å‘Š</strong>
			            <p>å³å°†æ‰§è¡Œå‹åŠ›æµ‹è¯•ï¼Œå¯èƒ½ä¼šé€ æˆï¼šï¼ˆç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œåä¸‡æ¬¡æ´—ç‰Œï¼ï¼ï¼ï¼‰</p>
			            <ul>
			                <li>â–¸ CPUä½¿ç”¨ç‡çŸ­æš‚é£™å‡</li>
			                <li>â–¸ æµè§ˆå™¨æš‚æ—¶æ— å“åº”ï¼ˆçº¦10-30ç§’ï¼‰</li>
			                <li>â–¸ ç§»åŠ¨è®¾å¤‡å¯èƒ½å‡ºç°æ˜æ˜¾å‘çƒ­</li>
			            </ul>
			            <p>å»ºè®®å…³é—­å…¶ä»–æ ‡ç­¾é¡µåç»§ç»­ï¼Œæ˜¯å¦ç¡®è®¤æ‰§è¡Œï¼Ÿ</p>
			            <button class="confirm">ç»§ç»­æ‰§è¡Œ</button>
			            <button class="cancel">å–æ¶ˆæ“ä½œ</button>
			        `;
					const backdrop = document.createElement('div');
					backdrop.className = 'modal-backdrop';
					const container = document.createElement('div');
					container.style.cssText = `
			            position: fixed;
			            top: 0;
			            left: 0;
			            width: 100%;
			            height: 100%;
			            display: flex;
			            justify-content: center;
			            align-items: center;
			        `;
					container.appendChild(alertBox);
					backdrop.appendChild(container);
					document.body.appendChild(backdrop);
					const handler = (result) => {
						document.body.removeChild(backdrop);
						resolve(result);
					};
					alertBox.querySelector('.confirm').addEventListener('click', () => handler(true));
					alertBox.querySelector('.cancel').addEventListener('click', () => handler(false));
					backdrop.addEventListener('click', (e) => {
						if (e.target === backdrop) handler(false);
					});
				});
			}

			function updateRemainingCounts() {
				const categories = {
					basic: {
						name: "åŸºæœ¬ç‰Œ",
						items: {}
					},
					trick: {
						name: "æ™®é€šé”¦å›Šç‰Œ",
						items: {}
					},
					ystrick: {
						name: "å»¶æ—¶é”¦å›Šç‰Œ",
						items: {}
					},
					weapon: {
						name: "æ­¦å™¨",
						items: {}
					},
					armor: {
						name: "é˜²å…·",
						items: {}
					},
					horse: {
						name: "åéª‘",
						items: {}
					}
				};
				deck.forEach(card => {
					for (const [type, items] of Object.entries(cardCategories)) {
						if (items.includes(card.name)) {
							categories[type].items[card.name] = (categories[type].items[card.name] || 0) + 1;
							break;
						}
					}
				});
				let html = '';
				for (const category of Object.values(categories)) {
					if (Object.keys(category.items).length === 0) continue;
					html += `<div class="category">
                   <div class="category-title">${category.name}</div>`;
					const sorted = Object.entries(category.items)
						.sort((a, b) => a[0].localeCompare(b[0], 'zh-Hans-CN'));
					html += sorted.map(([name, count]) =>
						`<div class="count-item">${name}ï¼š${count}</div>`
					).join('');

					html += '</div>';
				}
				document.getElementById('remaining-counts').innerHTML = html;
			}

			function drawCards(count) {
				if (deck.length === 0) {
					alert("ç‰Œå †å·²ç©ºï¼Œæ— æ³•ç»§ç»­æŠ½ç‰Œï¼");
					return;
				}
				if (deck.length < count) {
					alert(`ç‰Œå †ä»…å‰©${deck.length}å¼ ï¼Œè‡ªåŠ¨æŠ½å–å…¨éƒ¨`);
					count = deck.length;
				}
				for (let i = 0; i < count; i++) {
					const drawnCard = deck.shift();
					drawnCards.push(drawnCard);
					hand.push(drawnCard);
					if (drawnCard.name === "è¯¸è‘›è¿å¼©") {
						alert(`æŠ½åˆ°AKï¼å‰©ä½™ç‰Œå †ï¼š${deck.length}å¼ `);
					}
				}
				updateRemaining();
				updateReshuffleButton();
				updateUI();
			}

			function revealDeck() {
				const container = document.getElementById('remaining');
				if (deck.length === 0) {
					container.innerHTML = `<h3>å‰©ä½™ç‰Œå † (0å¼ )</h3><p>ç‰Œå †å·²ç©º</p>`;
					return;
				}
				container.innerHTML = `<h3>å‰©ä½™ç‰Œå † (${deck.length}å¼ )</h3>`;
				deck.forEach((card, index) => {
					container.innerHTML += `
                   <div class="card">
                       ${index + 1}. ${card.name} ${card.suit}${getPointDisplay(card.point)}
                   </div>`;
				});
			}

			function highlightZhugeLianNu() {
				const remainingCards = document.querySelectorAll('#remaining .card');
				if (deck.length === 0) {
					alert("ç‰Œå †å·²ç©ºï¼Œæ²¡æœ‰è¯¸è‘›è¿å¼©ï¼");
					return;
				}
				const akCards = Array.from(remainingCards).filter(card =>
					card.textContent.includes('è¯¸è‘›è¿å¼©')
				);
				akCards.forEach(card => card.classList.add('highlight'));
				const indices = akCards.map(card =>
					Array.from(remainingCards).indexOf(card) + 1
				);
				indices.length > 0 ?
					alert(`è¯¸è‘›è¿å¼©ä½ç½®ï¼š${indices.join(', ')}`) :
					alert("å‰©ä½™ç‰Œå †ä¸­æ²¡æœ‰è¯¸è‘›è¿å¼©ï¼");
			}

			function updateRemaining() {
				document.getElementById('remaining').innerHTML = `å‰©ä½™ç‰Œå †: ${deck.length}å¼ `;
				updateRemainingCounts();
			}

			function handleReshuffle() {
				if (!validateReshuffle()) return;
				log(`å¼€å§‹ä½¿ç”¨è„šæ°”å¡ï¼ˆå½“å‰å·²ç”¨${reshuffleUsed}æ¬¡ï¼‰`);
				const currentDrawn = hand.splice(-4, 4);
				log(`å›æ”¶æ‰‹ç‰Œï¼š${currentDrawn.map(c => c.name).join(', ')}`);
				deck.unshift(...currentDrawn);
				shuffleDeck();
				reshuffleUsed++;
				log(`è„šæ°”å¡æ´—ç‰Œå®Œæˆï¼ˆ${reshuffleUsed}/${MAX_RESHUFLE}æ¬¡ï¼‰`);
				discardPile.push(...drawnCards);
				drawnCards = [];
				drawCards(4);
				log(`é‡æ–°æŠ½å–4å¼ ç‰Œï¼Œå‰©ä½™ç‰Œå †ï¼š${deck.length}å¼ `);
				updateCounter();
				updateReshuffleButton();
			}

			function validateReshuffle() {
				const isValid = hand.length === 4 &&
					reshuffleUsed < MAX_RESHUFLE &&
					deck.length + hand.length >= 4;
				if (!isValid) {
					log(`è„šæ°”å¡ä½¿ç”¨å¤±è´¥ï¼ŒéªŒè¯æ¡ä»¶ä¸æ»¡è¶³ï¼š
                 æ‰‹ç‰Œæ•°: ${hand.length}
                 å·²ç”¨æ¬¡æ•°: ${reshuffleUsed}
                 å‰©ä½™ç‰Œæ•°: ${deck.length}`);
				}
				return isValid;
			}

			function clearDisplay() {
				document.getElementById('deck').innerHTML = '';
			}

			function updateReshuffleButton() {
				const btn = document.getElementById('reshuffleBtn');
				btn.disabled = !(drawnCards.length === 4 && reshuffleUsed < MAX_RESHUFLE);
			}

			function shuffleDeck() {
				for (let i = deck.length - 1; i > 0; i--) {
					const j = Math.floor(Math.random() * (i + 1));
					[deck[i], deck[j]] = [deck[j], deck[i]];
				}
				if (!deck.some(c => c.name === currentWeapon)) {
					currentWeapon = null;
					hasZhugeLianNu = false;
					killCount = 2;
				}
				peachCount = 1;
				document.getElementById('peach-counter').textContent = `æ¡ƒå¯ç”¨æ¬¡æ•°ï¼š1`;
				wineCount = 1;
				updateStatus();
				generateDeckAES();
				updateAESDisplay();
			}

			function startGame() {
				drawCards(4);
				phase = 'å‡†å¤‡';
				document.getElementById('drawBtn').disabled = false;
				document.getElementById('playBtn').disabled = true;
				updateUI();
			}

			function initializeButtons() {
				document.getElementById('drawBtn').disabled = false;
				document.getElementById('playBtn').disabled = true;
			}

			function drawPhase() {
				if (deck.length === 0) {
					alert("ç‰Œå †å·²ç©ºï¼Œæ— æ³•æ‘¸ç‰Œï¼");
					return;
				}
				phase = 'æ‘¸ç‰Œ';
				drawCards(3);
				document.getElementById('drawBtn').disabled = true;
				document.getElementById('playBtn').disabled = false;
				updateUI();
			}

			function playPhase() {
				phase = 'å‡ºç‰Œ';
				lastUsedCard = null;
				document.getElementById('drawBtn').disabled = true;
				document.getElementById('playBtn').disabled = true;
				document.getElementById('endPlayBtn').disabled = false;
				updateUI();
			}

			// ä½¿ç”¨å¡ç‰Œ
			// ä½¿ç”¨å¡ç‰Œ
			function useCard(card, index) {
			    // åªèƒ½åœ¨å‡ºç‰Œé˜¶æ®µä½¿ç”¨ç‰Œ
			    if (phase !== 'å‡ºç‰Œ') return;
			
			    // å»¶æ—¶é”¦å›Šä¸å‚ä¸æ— æ‡ˆå¯å‡»
			    const isDelayTrick = ["å…µç²®å¯¸æ–­", "ä¹ä¸æ€èœ€", "é—ªç”µ"].includes(card.name);
			    const isTrick = cardCategories.trick.includes(card.name);
			
			    //  å»¶æ—¶é”¦å›Šç‰Œå•ç‹¬å¤„ç†
			    if (isDelayTrick) {
			        handleDelayCard(card, index);
			        return; // é‡è¦ï¼šé¿å…ç»§ç»­æ‰§è¡Œåç»­é€»è¾‘
			    }
			
			    //  ç‰¹æ®Šå¤„ç†ï¼šç«æ”»ï¼ˆå·²å•ç‹¬å¤„ç†æ— æ‡ˆå¯å‡»ï¼‰
			    if (card.name === "ç«æ”»") {
			        resolveWuxie((shouldProceed) => {
			            if (!shouldProceed) {
			                // è¢«æ— æ‡ˆï¼šç›´æ¥å¼ƒæ‰
			                discardPile.push(hand.splice(index, 1)[0]);
			                log(`${card.name}è¢«æ— æ‡ˆå¯å‡»æŠµæ¶ˆ`);
			                updateUI();
			                return;
			            }
			            // æ— æ‡ˆæµç¨‹ç»“æŸï¼Œç»§ç»­æ­£å¸¸ç»“ç®—
			            handleHuogong(card, index);
			        });
			        return;
			    }
			
			    // é€šç”¨é”¦å›Šå¤„ç†ï¼ˆæ’é™¤ç«æ”»å’Œå»¶æ—¶é”¦å›Šï¼‰
			    if (isTrick && !isDelayTrick && card.name !== "ç«æ”»") {
			        resolveWuxie((shouldProceed) => {
			            if (!shouldProceed) {
			                // è¢«æ— æ‡ˆï¼šç›´æ¥å¼ƒæ‰
			                discardPile.push(hand.splice(index, 1)[0]);
			                log(`${card.name}è¢«æ— æ‡ˆå¯å‡»æŠµæ¶ˆ`);
			                updateUI();
			                return;
			            }
			            // æ— æ‡ˆæµç¨‹ç»“æŸï¼Œç»§ç»­æ­£å¸¸ç»“ç®—
			            continueUseCard(card, index);
			        });
			    } else {
			        // åŸºæœ¬ç‰Œ / è£…å¤‡ç‰Œ ç›´æ¥ç»“ç®—
			        continueUseCard(card, index);
			    }
			}


			function continueUseCard(card, index) {
				log(`ä½¿ç”¨å¡ç‰Œï¼š${card.name} ${card.suit}${getPointDisplay(card.point)}`);

				// æ­¦å™¨
				if (cardCategories.weapon.includes(card.name)) {
					if (currentWeapon && currentWeapon !== card.name && currentWeapon === "è¯¸è‘›è¿å¼©") {
						hasZhugeLianNu = false;
						killCount = 2;
						log(`å¸é™¤è¯¸è‘›è¿å¼©ï¼Œæ€æ¬¡æ•°é‡ç½®ä¸º2`);
					}
					currentWeapon = card.name;
					hasZhugeLianNu = (card.name === "è¯¸è‘›è¿å¼©");
					if (hasZhugeLianNu) log("è£…å¤‡è¯¸è‘›è¿å¼©ï¼Œæ€æ¬¡æ•°é™åˆ¶è§£é™¤");
				}

				// æ€ç±»å¡ç‰Œ
				if (['æ€', 'ç«æ€', 'é›·æ€'].includes(card.name)) {
					if (!hasZhugeLianNu && usedKillCount >= 2) {
						alert("æ€æ¬¡æ•°å·²ç”¨å°½ï¼");
						return;
					}
					usedKillCount++;
					log(`ä½¿ç”¨${card.name}ï¼Œå·²ä½¿ç”¨æ€æ¬¡æ•°ï¼š${usedKillCount}`);
				}

				// æ— ä¸­ç”Ÿæœ‰
				if (card.name === "æ— ä¸­ç”Ÿæœ‰") {
					log('ä½¿ç”¨æ— ä¸­ç”Ÿæœ‰ï¼Œé¢å¤–æ‘¸ä¸¤å¼ ç‰Œï¼');
					drawCards(2);
				}

				// è¿‡æ²³æ‹†æ¡¥ / é¡ºæ‰‹ç‰µç¾Š / å†³æ–— / å€Ÿåˆ€æ€äºº / äº”è°·ä¸°ç™» / é“ç´¢è¿ç¯
				if (card.name === "è¿‡æ²³æ‹†æ¡¥") {
					handleGuohe(card, index);
					return;
				}
				if (card.name === "é¡ºæ‰‹ç‰µç¾Š") {
					handleShunshou(card, index);
					return;
				}
				if (card.name === "å†³æ–—") {
					handleDuel(card, index);
					return;
				}
				if (card.name === "å€Ÿåˆ€æ€äºº") {
					showJiedaoDialog(card, index);
					return;
				}
				if (card.name === "äº”è°·ä¸°ç™»") {
					showWugufengdengDialog(card, index);
					return;
				}
				if (card.name === "é“ç´¢è¿ç¯") {
					showChainDialog(card, index);
					return;
				}

				// æ¡ƒ
				if (card.name === "æ¡ƒ") {
					if (peachCount <= 0) {
						alert("æ¡ƒä½¿ç”¨æ¬¡æ•°å·²è€—å°½ï¼");
						return;
					}
					peachCount--;
					log(`ä½¿ç”¨æ¡ƒï¼Œå‰©ä½™æ¬¡æ•°ï¼š${peachCount}`);
				}

				// é…’
				if (card.name === "é…’") {
					if (wineCount <= 0) {
						alert("é…’ä½¿ç”¨æ¬¡æ•°å·²è€—å°½ï¼");
						return;
					}
					wineCount--;
					wineEffect = true;
					log(`ä½¿ç”¨é…’ï¼Œä¸‹ä¸€å¼ æ€ä¼¤å®³+1`);
				}

				// ä¼¤å®³è®¡ç®—
				let damage = 0;
				switch (card.name) {
					case 'æ€':
					case 'é›·æ€':
						damage = wineEffect ? 2 : 1;
						wineEffect = false;
						break;
					case 'ç«æ€':
						damage = wineEffect ? 3 : 2;
						wineEffect = false;
						break;
					case 'å—è›®å…¥ä¾µ':
					case 'ä¸‡ç®­é½å‘':
						damage = 2;
						break;
				}
				if (damage > 0) {
					totalDamage += damage;
					currentTurnDamage += damage;
					log(`é€ æˆ${damage}ç‚¹ä¼¤å®³ï¼ˆæ€»ä¼¤å®³ï¼š${totalDamage}ï¼Œå½“å‰å›åˆä¼¤å®³ï¼š${currentTurnDamage}ï¼‰`);
				}

				// æ¸è¥
				if (lastUsedCard && (card.suit === lastUsedCard.suit || card.point === lastUsedCard.point)) {
					log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
					drawCards(1);
				}
				lastUsedCard = card;

				// ç§»é™¤æ‰‹ç‰Œ
				discardPile.push(hand.splice(index, 1)[0]);
				updateStatus();
				updateUI();
			}

			// å¤„ç†ç«æ”»æ•ˆæœ
			function handleHuogong(card, index) {
				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';

				// åˆ›å»ºå¯¹è¯æ¡†
				const dialog = document.createElement('div');
				dialog.className = 'huogong-dialog';
				dialog.style = `
			        position: fixed;
			        top: 50%;
			        left: 50%;
			        transform: translate(-50%, -50%);
			        background: #ffecb3;
			        padding: 20px;
			        border-radius: 10px;
			        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
			        z-index: 10001;
			        min-width: 450px;
			        text-align: center;
			    `;

				// å¯¹è¯æ¡†å†…å®¹
				dialog.innerHTML = `
			        <h3 style="color:#d32f2f; margin-top:0;">ç«æ”»æ•ˆæœé€‰æ‹©</h3>
			        <p>è¯·é€‰æ‹©ç«æ”»çš„ç›®æ ‡ï¼š</p>
			        <div style="display: flex; justify-content: center; gap: 20px; margin: 20px 0;">
			            <button id="selfTarget" class="dialog-button" style="background:#4CAF50; padding: 10px 20px;">
			                å¯¹è‡ªå·±ä½¿ç”¨
			            </button>
			            <button id="otherTarget" class="dialog-button" style="background:#f44336; padding: 10px 20px;">
			                å¯¹ä»–äººä½¿ç”¨
			            </button>
			        </div>
			    `;

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);

				// å¯¹è‡ªå·±ä½¿ç”¨
				dialog.querySelector('#selfTarget').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					handleSelfHuogong(card, index);
				});

				// å¯¹ä»–äººä½¿ç”¨
				dialog.querySelector('#otherTarget').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					handleOtherHuogong(card, index);
				});

				// ç‚¹å‡»èƒŒæ™¯å…³é—­å¯¹è¯æ¡†
				overlay.addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					// ç«æ”»æœªä½¿ç”¨ï¼Œéœ€è¦æ”¾å›æ‰‹ç‰Œ
					log("å–æ¶ˆäº†ç«æ”»æ•ˆæœ");
				});
			}

			// å¤„ç†å¯¹è‡ªå·±ä½¿ç”¨ç«æ”»
			function handleSelfHuogong(card, index) {
				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
			 overlay.className = 'modal-backdrop';

				// åˆ›å»ºå¯¹è¯æ¡†
				const dialog = document.createElement('div');
				dialog.className = 'huogong-options';
				dialog.style = `
			        position: fixed;
			        top: 50%;
			        left: 50%;
			        transform: translate(-50%, -50%);
			        background: #ffecb3;
			        padding: 20px;
			        border-radius: 10px;
			        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
			        z-index: 10001;
			        min-width: 450px;
			        text-align: center;
			    `;

				// å¯¹è¯æ¡†å†…å®¹
				dialog.innerHTML = `
			        <h3 style="color:#d32f2f; margin-top:0;">å¯¹è‡ªå·±ä½¿ç”¨ç«æ”»</h3>
			        <p>è¯·é€‰æ‹©æ•ˆæœï¼š</p>
			        <div style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
			            <button id="selfEnd" class="dialog-button" style="background:#4CAF50;">
			                ç»“æŸç»“ç®—ï¼šæ— äº‹å‘ç”Ÿ
			            </button>
			            <button id="selfDiscard" class="dialog-button" style="background:#f44336;">
			                å¼ƒç½®ä¸€å¼ æ‰‹ç‰Œï¼šæ¡ƒå¯ç”¨æ¬¡æ•°+1
			            </button>
			        </div>
			    `;

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
			 document.body.appendChild(dialog);

				// ç»“æŸç»“ç®—é€‰é¡¹
				dialog.querySelector('#selfEnd').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					// ä»æ‰‹ç‰Œä¸­ç§»é™¤ç«æ”»
					const usedCard = hand.splice(index, 1)[0];
					discardPile.push(usedCard);
					log(`ä½¿ç”¨ç«æ”»ï¼ˆå¯¹è‡ªå·±ï¼‰ï¼šæ— äº‹å‘ç”Ÿ`);

					// æ£€æŸ¥æ¸è¥æŠ€èƒ½
					if (lastUsedCard &&
						(usedCard.suit === lastUsedCard.suit ||
							usedCard.point === lastUsedCard.point)) {
						log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
						drawCards(1);
					}

					// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œ
					lastUsedCard = usedCard;
					updateUI();
				});

				// å¼ƒç½®æ‰‹ç‰Œé€‰é¡¹
				dialog.querySelector('#selfDiscard').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					// ä»æ‰‹ç‰Œä¸­ç§»é™¤ç«æ”»
					const usedCard = hand.splice(index, 1)[0];
					discardPile.push(usedCard);
					log(`ä½¿ç”¨ç«æ”»ï¼ˆå¯¹è‡ªå·±ï¼‰ï¼šå¼ƒç½®ä¸€å¼ æ‰‹ç‰Œ`);

					// æ˜¾ç¤ºå¼ƒç‰Œé€‰æ‹©å¯¹è¯æ¡†
					showDiscardOptions(card, true);
				});
			}

			// å¤„ç†å¯¹ä»–äººä½¿ç”¨ç«æ”»
			function handleOtherHuogong(card, index) {
				// æ£€æŸ¥ç‰Œå †æ˜¯å¦ä¸ºç©º
				if (deck.length === 0) {
					alert("ç‰Œå †å·²ç©ºï¼Œæ— æ³•ä½¿ç”¨ç«æ”»ï¼");
					log("ç«æ”»å¤±è´¥ï¼šç‰Œå †å·²ç©º");
					return;
				}

				// äº®å‡ºç‰Œå †é¡¶çš„ä¸€å¼ ç‰Œ
				const revealedCard = deck.shift();
				log(`ç«æ”»äº®å‡ºç‰Œå †é¡¶ç‰Œï¼š${revealedCard.name} ${revealedCard.suit}${getPointDisplay(revealedCard.point)}`);

				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';

				// åˆ›å»ºå¯¹è¯æ¡†
			 const dialog = document.createElement('div');
				dialog.className = 'huogong-options';
				dialog.style = `
			        position: fixed;
			        top: 50%;
			        left: 50%;
			        transform: translate(-50%, -50%);
			        background: #ffecb3;
			        padding: 20px;
			        border-radius: 10px;
			        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
			        z-index: 10001;
			        min-width: 450px;
			        text-align: center;
			    `;

				// å¯¹è¯æ¡†å†…å®¹
				dialog.innerHTML = `
			        <h3 style="color:#d32f2f; margin-top:0;">å¯¹ä»–äººä½¿ç”¨ç«æ”»</h3>
			        <div style="background:#ffd54f; padding: 10px; border-radius: 5px; margin: 10px 0;">
			            <p style="margin:0; font-weight:bold;">äº®å‡ºçš„ç‰Œï¼š</p>
			            <p style="margin:0; font-size: 24px;">
			                ${revealedCard.name} ${revealedCard.suit}${getPointDisplay(revealedCard.point)}
			            </p>
			        </div>
			        <p>è¯·é€‰æ‹©æ•ˆæœï¼š</p>
			        <div style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
			            <button id="otherEnd" class="dialog-button" style="background:#4CAF50;">
			                ç»“æŸç»“ç®—ï¼šæ— äº‹å‘ç”Ÿ
			            </button>
			            <button id="otherDiscard" class="dialog-button" style="background:#f44336;">
			                å¼ƒç½®ä¸€å¼ ${revealedCard.suit}èŠ±è‰²æ‰‹ç‰Œï¼šå›åˆä¼¤å®³+1
			            </button>
			        </div>
			    `;

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);

				// ç»“æŸç»“ç®—é€‰é¡¹
				dialog.querySelector('#otherEnd').addEventListener('click', () => {
					document.body.removeChild(overlay);
			  document.body.removeChild(dialog);
					// ä»æ‰‹ç‰Œä¸­ç§»é™¤ç«æ”»
					const usedCard = hand.splice(index, 1)[0];
					discardPile.push(usedCard);
					// äº®å‡ºçš„ç‰Œè¿›å…¥å¼ƒç‰Œå †
					discardPile.push(revealedCard);
					log(`ä½¿ç”¨ç«æ”»ï¼ˆå¯¹ä»–äººï¼‰ï¼šæ— äº‹å‘ç”Ÿ`);

					// æ£€æŸ¥æ¸è¥æŠ€èƒ½
					if (lastUsedCard &&
						(usedCard.suit === lastUsedCard.suit ||
							usedCard.point === lastUsedCard.point)) {
						log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
						drawCards(1);
					}

					// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œ
					lastUsedCard = usedCard;
					updateUI();
			 });

				// å¼ƒç½®æ‰‹ç‰Œé€‰é¡¹
				dialog.querySelector('#otherDiscard').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					// ä»æ‰‹ç‰Œä¸­ç§»é™¤ç«æ”»
					const usedCard = hand.splice(index, 1)[0];
					discardPile.push(usedCard);
					// äº®å‡ºçš„ç‰Œè¿›å…¥å¼ƒç‰Œå †
					discardPile.push(revealedCard);
					log(`ä½¿ç”¨ç«æ”»ï¼ˆå¯¹ä»–äººï¼‰ï¼šéœ€å¼ƒç½®ä¸€å¼ ${revealedCard.suit}èŠ±è‰²æ‰‹ç‰Œ`);

					// æ˜¾ç¤ºå¼ƒç‰Œé€‰æ‹©å¯¹è¯æ¡†
					showDiscardOptions(card, false, revealedCard.suit);
				});
			}

			// æ˜¾ç¤ºå¼ƒç‰Œé€‰æ‹©å¯¹è¯æ¡†
			function showDiscardOptions(huogongCard, isSelf, requiredSuit = null) {
				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
			 overlay.className = 'modal-backdrop';

				// åˆ›å»ºå¯¹è¯æ¡†
				const dialog = document.createElement('div');
				dialog.className = 'discard-options';
				dialog.style = `
			        position: fixed;
			        top: 50%;
			        left: 50%;
			        transform: translate(-50%, -50%);
			        background: white;
			        padding: 20px;
			        border-radius: 10px;
			        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
			        z-index: 10001;
			        min-width: 450px;
			        text-align: center;
			    `;

				// å¯¹è¯æ¡†æ ‡é¢˜
				const title = isSelf ?
					"å¼ƒç½®ä¸€å¼ æ‰‹ç‰Œï¼ˆæ¡ƒå¯ç”¨æ¬¡æ•°+1ï¼‰" :
					`å¼ƒç½®ä¸€å¼ ${requiredSuit}èŠ±è‰²æ‰‹ç‰Œï¼ˆå›åˆä¼¤å®³+1ï¼‰`;

				dialog.innerHTML = `
			        <h3 style="color:#d32f2f; margin-top:0;">${title}</h3>
			        <p>è¯·é€‰æ‹©è¦å¼ƒç½®çš„æ‰‹ç‰Œï¼š</p>
			        <div id="handCardsContainer" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0;"></div>
			        <button id="cancelDiscard" class="dialog-button" style="background:#9e9e9e;">
			            å–æ¶ˆå¼ƒç‰Œ
			        </button>
			    `;

				// è·å–æ‰‹ç‰Œå®¹å™¨
				const cardsContainer = dialog.querySelector('#handCardsContainer');

				// æ·»åŠ æ¯å¼ å¯å¼ƒç½®çš„æ‰‹ç‰Œ
				hand.forEach((card, i) => {
					// å¯¹ä»–äººä½¿ç”¨æ—¶éœ€è¦åŒ¹é…èŠ±è‰²
					if (!isSelf && card.suit !== requiredSuit) return;

					const cardDiv = document.createElement('div');
					cardDiv.className = 'discard-card';
					cardDiv.innerHTML = `
			            <div style="font-size: 18px; font-weight: bold;">${card.name}</div>
			            <div style="font-size: 24px;">${card.suit}${getPointDisplay(card.point)}</div>
			        `;

					// æ·»åŠ ç‚¹å‡»äº‹ä»¶
					cardDiv.addEventListener('click', () => {
						// å¼ƒç½®é€‰ä¸­çš„æ‰‹ç‰Œ
						const discardedCard = hand.splice(i, 1)[0];
						discardPile.push(discardedCard);
						log(
						`å¼ƒç½®æ‰‹ç‰Œï¼š${discardedCard.name} ${discardedCard.suit}${getPointDisplay(discardedCard.point)}`);

						// åº”ç”¨ç«æ”»æ•ˆæœ
						if (isSelf) {
							// å¯¹è‡ªå·±ä½¿ç”¨ï¼šæ¡ƒå¯ç”¨æ¬¡æ•°+1
							peachCount = Math.min(peachCount + 1, 3);
							log(`æ¡ƒå¯ç”¨æ¬¡æ•°+1ï¼ˆå½“å‰ï¼š${peachCount}ï¼‰`);
						} else {
							// å¯¹ä»–äººä½¿ç”¨ï¼šå›åˆä¼¤å®³+1
							currentTurnDamage++;
							totalDamage++;
							log(`å›åˆä¼¤å®³+1ï¼ˆå½“å‰å›åˆä¼¤å®³ï¼š${currentTurnDamage}ï¼Œæ€»ä¼¤å®³ï¼š${totalDamage}ï¼‰`);
						}

						// æ£€æŸ¥æ¸è¥æŠ€èƒ½ï¼ˆä½¿ç”¨ç«æ”»ç‰Œï¼‰
						if (lastUsedCard &&
							(huogongCard.suit === lastUsedCard.suit ||
								huogongCard.point === lastUsedCard.point)) {
							log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
							drawCards(1);
						}

						// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œï¼ˆç«æ”»ç‰Œï¼‰
						lastUsedCard = huogongCard;

						// å…³é—­å¯¹è¯æ¡†
						document.body.removeChild(overlay);
						document.body.removeChild(dialog);
						updateStatus();
						updateUI();
					});

					cardsContainer.appendChild(cardDiv);
				});

				// å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„ç‰Œ
				if (cardsContainer.children.length === 0) {
					cardsContainer.innerHTML = `<p>æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å¯å¼ƒç½®æ‰‹ç‰Œ</p>`;
				}

			 // å–æ¶ˆæŒ‰é’®
				dialog.querySelector('#cancelDiscard').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					log("å–æ¶ˆäº†å¼ƒç‰Œæ“ä½œ");
				});

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			}

			function updateStatus() {
				const counter = document.getElementById('kill-counter');
				const zhuge = document.getElementById('zhuge-status');

				// ç»Ÿä¸€æ ¼å¼ï¼šå‰©ä½™å¯ç”¨ / å·²ä½¿ç”¨
				const remainingText = hasZhugeLianNu ? 'âˆ' : Math.max(0, 2 - usedKillCount);
				counter.textContent = `æ€å¯ç”¨æ¬¡æ•°ï¼š${remainingText}ï¼Œæœ¬å›åˆå·²ä½¿ç”¨æ€çš„ä¸ªæ•°ï¼š${usedKillCount}`;

				// å…¶å®ƒçŠ¶æ€
				document.getElementById('peach-counter').textContent = `æ¡ƒå¯ç”¨æ¬¡æ•°ï¼š${peachCount}`;
				document.getElementById('wine-counter').textContent = `é…’å¯ç”¨æ¬¡æ•°ï¼š${wineCount}`;
				document.getElementById('total-damage').textContent = `æ€»ä¼¤å®³: ${totalDamage}`;
				document.getElementById('turn-damage').textContent = `å½“å‰å›åˆä¼¤å®³: ${currentTurnDamage}`;
				zhuge.textContent = currentWeapon ? `å½“å‰æ­¦å™¨ï¼š${currentWeapon}` : "å½“å‰æ­¦å™¨ï¼šæ— ";

				updateDelayArea();
			}
			
			function resolveWuxie(callback) {
				const wuxieCards = hand.filter(c => c.name === 'æ— æ‡ˆå¯å‡»');
				if (wuxieCards.length === 0) {
					callback(true); // æ²¡æœ‰æ— æ‡ˆï¼Œé”¦å›Šç”Ÿæ•ˆ
					return;
				}
			
				let useCount = 0;
			
				function promptNext() {
					const remaining = hand.filter(c => c.name === 'æ— æ‡ˆå¯å‡»');
					if (remaining.length === 0) {
						callback(useCount % 2 === 0); // å¶æ•°ç”Ÿæ•ˆï¼Œå¥‡æ•°å¤±æ•ˆ
						return;
					}
			
					// ä¿®æ”¹ç‚¹ï¼šæ·»åŠ useCountå‚æ•°
			 	showWuxieDialog(remaining, useCount, (usedCard) => {
						if (!usedCard) {
							callback(useCount % 2 === 0); // ç”¨æˆ·é€‰æ‹©ä¸å†ä½¿ç”¨
							return;
						}
			
						// ä½¿ç”¨æ— æ‡ˆå¯å‡»
						const idx = hand.findIndex(c => c.uid === usedCard.uid);
						if (idx !== -1) {
							discardPile.push(hand.splice(idx, 1)[0]);
							log(`ä½¿ç”¨æ— æ‡ˆå¯å‡»: ${usedCard.suit}${getPointDisplay(usedCard.point)}`);
							useCount++;
			
							// è§¦å‘æ¸è¥
							if (lastUsedCard && (usedCard.suit === lastUsedCard.suit || usedCard.point === lastUsedCard
									.point)) {
								log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
								drawCards(1);
							}
							lastUsedCard = usedCard;
						}
			
						promptNext(); // é€’å½’ç»§ç»­
					});
				}
			
				promptNext();
			}
			
			function showWuxieDialog(wuxieCards, useCount, callback) {
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';
			
				const dialog = document.createElement('div');
				dialog.className = 'card-selector-modal';
			
				// æ·»åŠ çŠ¶æ€æç¤ºä¿¡æ¯
				dialog.innerHTML = `
			        <h3>æ˜¯å¦ä½¿ç”¨æ— æ‡ˆå¯å‡»ï¼Ÿ</h3>
			        <div style="background:#f9f9f9; padding:8px; margin-bottom:10px; border-radius:5px; border:1px solid #eee;">
			            <p style="margin:0; color:#FF5722; font-weight:bold;">
			                å·²ä½¿ç”¨ç¬¬<span id="wuxie-count">${useCount}</span>å¼ æ— æ‡ˆå¯å‡»
			            </p>
			            <p style="margin:5px 0 0; font-size:14px;">
			                å½“å‰é”¦å›ŠçŠ¶æ€: <strong>${useCount % 2 === 0 ? "ç”Ÿæ•ˆ" : "å¤±æ•ˆ"}</strong>
			            </p>
			        </div>
			        <div class="card-options">
			            ${wuxieCards.map((c, i) => `
			                <button class="wuxie-card" data-index="${i}">
			                    ${c.suit}${getPointDisplay(c.point)}
			                </button>
			            `).join('')}
			        </div>
			        <button class="dialog-button" id="stopWuxie">ä¸å†ä½¿ç”¨æ— æ‡ˆå¯å‡»</button>
			    `;
			
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			
				dialog.querySelectorAll('.wuxie-card').forEach(btn => {
					btn.addEventListener('click', () => {
						const idx = parseInt(btn.dataset.index);
						document.body.removeChild(overlay);
						document.body.removeChild(dialog);
						callback(wuxieCards[idx]);
					});
				});
			
			 dialog.querySelector('#stopWuxie').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					callback(null); // ä¸å†ä½¿ç”¨
				});
			
				overlay.addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					callback(null);
				});
			}

			// å†³æ–—å‡½æ•°
			function handleDuel(card, index) {
				// ä»æ‰‹ç‰Œç§»é™¤å†³æ–—å¡ç‰Œ
				const duelCard = hand.splice(index, 1)[0];
				discardPile.push(duelCard);
				log(`ä½¿ç”¨å†³æ–—: ${duelCard.suit}${getPointDisplay(duelCard.point)}`);

				// æ£€æŸ¥æ¸è¥æŠ€èƒ½ï¼ˆä½¿ç”¨å†³æ–—æœ¬èº«ï¼‰
				if (lastUsedCard && (duelCard.suit === lastUsedCard.suit || duelCard.point === lastUsedCard.point)) {
					log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
					drawCards(1);
				}

				// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œä¸ºå†³æ–—
				lastUsedCard = duelCard;

				// æ˜¾ç¤ºå†³æ–—å¯¹è¯æ¡†
				showDuelDialog();
			}

			// å†³æ–—å¯¹è¯æ¡†å‡½æ•°
			function showDuelDialog() {
				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';

				// åˆ›å»ºå¯¹è¯æ¡†
				const dialog = document.createElement('div');
				dialog.className = 'duel-dialog';
				dialog.style = `
			          position: fixed;
			          top: 50%;
			          left: 50%;
			          transform: translate(-50%, -50%);
			          background: #ffecb3;
			          padding: 20px;
			          border-radius: 10px;
			          box-shadow: 0 4px 15px rgba(0,0,0,0.2);
			          z-index: 10001;
			          min-width: 450px;
			          text-align: center;
			      `;

				// è·å–æ‰€æœ‰æ€ç±»å¡ç‰Œ
				const killCards = hand.filter(card => ['æ€', 'ç«æ€', 'é›·æ€'].includes(card.name));

				// å¯¹è¯æ¡†å†…å®¹
				dialog.innerHTML = `
			          <h3 style="color:#d32f2f; margin-top:0;">å†³æ–—ç»“ç®—</h3>
			          <p>è¯·é€‰æ‹©è¦æ‰“å‡ºçš„æ€ç‰Œï¼ˆç‚¹å‡»å¡ç‰Œé€‰æ‹©ï¼‰ï¼š</p>
			          <div class="card-options" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0;">
			              ${killCards.length > 0 ? 
			                  killCards.map((card, i) => `
			                      <div class="duel-card" data-index="${i}">
			                          <div style="font-size: 18px; font-weight: bold;">${card.name}</div>
			                          <div style="font-size: 24px;">${card.suit}${getPointDisplay(card.point)}</div>
			                      </div>
			                  `).join('') : 
			                  '<p>æ‰‹ç‰Œä¸­æ²¡æœ‰æ€ç±»å¡ç‰Œ</p>'
			              }
			          </div>
			          <div style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
			              <button id="addPeach" class="dialog-button" style="background:#4CAF50; padding: 10px 20px;">
			                  æ¡ƒ+1ï¼ˆä½ å—åˆ°å†³æ–—çš„ä¼¤å®³ï¼‰
			              </button>
			              <button id="addDamage" class="dialog-button" style="background:#f44336; padding: 10px 20px;">
			                  ä¼¤å®³+1ï¼ˆå…¶ä»–è§’è‰²å—åˆ°äº†ä¼¤å®³ï¼‰
			              </button>
			          </div>
			      `;

				// æ·»åŠ å¡ç‰Œç‚¹å‡»äº‹ä»¶
				if (killCards.length > 0) {
					dialog.querySelectorAll('.duel-card').forEach(cardDiv => {
						cardDiv.addEventListener('click', function() {
							const cardIndex = parseInt(this.dataset.index);
							const selectedCard = killCards[cardIndex];

							// ä»æ‰‹ç‰Œä¸­ç§»é™¤
							const handIndex = hand.findIndex(c => c.uid === selectedCard.uid);
							if (handIndex !== -1) {
								discardPile.push(hand.splice(handIndex, 1)[0]);
								log(
									`å› å†³æ–—æ‰“å‡ºæ€: ${selectedCard.name} ${selectedCard.suit}${getPointDisplay(selectedCard.point)}`
									);
							}

							// é‡æ–°æ¸²æŸ“å¯¹è¯æ¡†ï¼ˆç»§ç»­å†³æ–—ç»“ç®—ï¼‰
							document.body.removeChild(overlay);
							document.body.removeChild(dialog);
							showDuelDialog();
						});
					});
				}

				// æ¡ƒ+1æŒ‰é’®
				dialog.querySelector('#addPeach').addEventListener('click', () => {
					peachCount = Math.min(peachCount + 1, 3);
					log(`å†³æ–—ç»ˆæ­¢ï¼Œæ¡ƒå¯ç”¨æ¬¡æ•°+1ï¼ˆå½“å‰: ${peachCount}ï¼‰`);
					closeDuelDialog(overlay, dialog);
				});

				// ä¼¤å®³+1æŒ‰é’®
				dialog.querySelector('#addDamage').addEventListener('click', () => {
					totalDamage++;
					currentTurnDamage++;
					log(`å†³æ–—ç»ˆæ­¢ï¼Œä¼¤å®³+1ï¼ˆæ€»ä¼¤å®³: ${totalDamage}ï¼Œå½“å‰å›åˆä¼¤å®³: ${currentTurnDamage}ï¼‰`);
					closeDuelDialog(overlay, dialog);
				});

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);

				// æ·»åŠ å¡ç‰Œæ‚¬åœæ•ˆæœ
				if (killCards.length > 0) {
					dialog.querySelectorAll('.duel-card').forEach(card => {
						card.addEventListener('mouseenter', () => {
							card.style.transform = 'translateY(-5px)';
							card.style.boxShadow = '0 6px 12px rgba(0,0,0,0.15)';
						});
						card.addEventListener('mouseleave', () => {
							card.style.transform = 'none';
							card.style.boxShadow = 'none';
						});
					});
				}
			}

			// å…³é—­å†³æ–—å¯¹è¯æ¡†
			function closeDuelDialog(overlay, dialog) {
				document.body.removeChild(overlay);
				document.body.removeChild(dialog);
				updateStatus();
				updateUI();
			}

			// å¤„ç†è¿‡æ²³æ‹†æ¡¥æ•ˆæœ
			function handleGuohe(card, index) {
				// è·å–æ‰€æœ‰å¯æ‹†é™¤çš„å»¶æ—¶é”¦å›Šï¼ˆå…µç²®å¯¸æ–­å’Œä¹ä¸æ€èœ€ï¼‰
				const delayCards = [...bingliangArea, ...lebuArea];

				// æ£€æŸ¥æ˜¯å¦æœ‰å¯æ‹†é™¤çš„ç‰Œ
				if (delayCards.length > 0) {
					// æœ‰å»¶æ—¶é”¦å›Šï¼Œæ˜¾ç¤ºé€‰æ‹©å¯¹è¯æ¡†
					showGuoheDialog(card, index, delayCards);
				} else {
					// æ²¡æœ‰å»¶æ—¶é”¦å›Šï¼Œç›´æ¥ä½¿ç”¨å¡ç‰Œå¹¶æ£€æŸ¥æ¸è¥
					useGuohe(card, index);
				}
			}

			// æ˜¾ç¤ºè¿‡æ²³æ‹†æ¡¥é€‰æ‹©å¯¹è¯æ¡†
			function showGuoheDialog(card, index, delayCards) {
				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';

				// åˆ›å»ºå¯¹è¯æ¡†
				const dialog = document.createElement('div');
				dialog.className = 'card-selector-modal';
				dialog.innerHTML = `
			        <h3>è¿‡æ²³æ‹†æ¡¥ - é€‰æ‹©è¦æ‹†é™¤çš„å»¶æ—¶é”¦å›Š</h3>
			        <p>è¯·é€‰æ‹©è¦æ‹†é™¤çš„ç‰Œï¼ˆç‚¹å‡»å¡ç‰Œé€‰æ‹©ï¼‰ï¼š</p>
			        <div id="delayCardsContainer" style="display: flex; flex-wrap: wrap; gap: 10px; margin: 15px 0;"></div>
			        <button id="noRemove" class="dialog-button" style="background:#C8E6C9;">
			            ä¸æ‹†é™¤ï¼Œä»…ä½¿ç”¨æ•ˆæœ
			        </button>
			    `;

				// è·å–å¡ç‰Œå®¹å™¨
				const cardsContainer = dialog.querySelector('#delayCardsContainer');

				// æ·»åŠ æ¯å¼ å¯æ‹†é™¤çš„å¡ç‰Œ
				delayCards.forEach((delayCard, i) => {
					const cardDiv = document.createElement('div');
					cardDiv.className = 'delay-card-selectable';
					cardDiv.innerHTML = `
			            <div>${delayCard.name}</div>
			            <div>${delayCard.suit}${getPointDisplay(delayCard.point)}</div>
			        `;

					// æ·»åŠ ç‚¹å‡»äº‹ä»¶
					cardDiv.addEventListener('click', () => {
						removeSpecificDelayCard(delayCard);
						useGuohe(card, index);
						closeAllModals();
					});

					cardsContainer.appendChild(cardDiv);
				});

				// å…³é—­æ‰€æœ‰å¼¹çª—çš„å‡½æ•°
				const closeAllModals = () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
				};

				// "ä¸æ‹†é™¤"æŒ‰é’®
				dialog.querySelector('#noRemove').addEventListener('click', () => {
					closeAllModals();
					useGuohe(card, index);
				});

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			}

			// ç§»é™¤æŒ‡å®šçš„å»¶æ—¶é”¦å›Š
			function removeSpecificDelayCard(delayCard) {
				// ç¡®å®šå¡ç‰Œåœ¨å“ªä¸ªåŒºåŸŸ
				let area = null;
				let index = -1;

				// æ£€æŸ¥å…µç²®å¯¸æ–­åŒº
				index = bingliangArea.findIndex(c => c.uid === delayCard.uid);
				if (index !== -1) {
					area = bingliangArea;
				}
				// æ£€æŸ¥ä¹ä¸æ€èœ€åŒº
				else {
					index = lebuArea.findIndex(c => c.uid === delayCard.uid);
					if (index !== -1) {
						area = lebuArea;
					}
				}

				// å¦‚æœæ‰¾åˆ°å¡ç‰Œï¼Œåˆ™ç§»é™¤
				if (area && index !== -1) {
					const removedCard = area.splice(index, 1)[0];
					discardPile.push(removedCard);
					log(`æ‹†é™¤${removedCard.name}: ${removedCard.suit}${getPointDisplay(removedCard.point)}`);

					// æ›´æ–°çŠ¶æ€æ˜¾ç¤º
					updateStatus();
				}
			}

			// ä½¿ç”¨è¿‡æ²³æ‹†æ¡¥å¡ç‰Œ
			function useGuohe(card, index) {
				// ä»æ‰‹ç‰Œç§»é™¤
				const usedCard = hand.splice(index, 1)[0];

				// æ”¾å…¥å¼ƒç‰Œå †
				discardPile.push(usedCard);

				log(`ä½¿ç”¨è¿‡æ²³æ‹†æ¡¥: ${usedCard.suit}${getPointDisplay(usedCard.point)}`);

				// æ£€æŸ¥æ¸è¥æŠ€èƒ½
				if (lastUsedCard &&
					(usedCard.suit === lastUsedCard.suit ||
						usedCard.point === lastUsedCard.point)) {
					log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
					drawCards(1);
				}

				// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œ
				lastUsedCard = usedCard;

				// æ›´æ–°ç•Œé¢
				updateStatus();
				updateUI();
			}

			// æ›´æ–°å»¶æ—¶é”¦å›ŠåŒºåŸŸæ˜¾ç¤º
			function updateDelayArea() {
				const bingliangContainer = document.getElementById('bingliang-container');
				const lebuContainer = document.getElementById('lebu-container');
				const shandianContainer = document.getElementById('shandian-container'); // æ–°å¢

				// æ¸…ç©ºå®¹å™¨
				bingliangContainer.innerHTML = '';
				lebuContainer.innerHTML = '';
				shandianContainer.innerHTML = ''; // æ–°å¢

				// å…µç²®å¯¸æ–­åŒºåŸŸ
				if (bingliangArea.length === 0) {
					bingliangContainer.innerHTML = '<div class="delay-card disabled">ç©º</div>';
				} else {
					bingliangArea.forEach(card => {
						const cardDiv = document.createElement('div');
						cardDiv.className = 'delay-card';
						cardDiv.textContent = `${card.name} ${card.suit}${getPointDisplay(card.point)}`;
						bingliangContainer.appendChild(cardDiv);
					});
				}

				// ä¹ä¸æ€èœ€åŒºåŸŸ
				if (lebuArea.length === 0) {
					lebuContainer.innerHTML = '<div class="delay-card disabled">ç©º</div>';
				} else {
					lebuArea.forEach(card => {
						const cardDiv = document.createElement('div');
						cardDiv.className = 'delay-card';
						cardDiv.textContent = `${card.name} ${card.suit}${getPointDisplay(card.point)}`;
						lebuContainer.appendChild(cardDiv);
					});
				}

				// é—ªç”µåŒºåŸŸ
				if (shandianArea.length === 0) {
					shandianContainer.innerHTML = '<div class="delay-card disabled">ç©º</div>';
				} else {
					shandianArea.forEach(card => {
						const cardDiv = document.createElement('div');
						cardDiv.className = 'delay-card';
						cardDiv.textContent = `${card.name} ${card.suit}${getPointDisplay(card.point)}`;
						shandianContainer.appendChild(cardDiv);
					});
				}
			}

			// å¤„ç†é¡ºæ‰‹ç‰µç¾Šæ•ˆæœ
			function handleShunshou(card, index) {
				// è·å–æ‰€æœ‰å¯è·å–çš„å»¶æ—¶é”¦å›Šï¼ˆå…µç²®å¯¸æ–­å’Œä¹ä¸æ€èœ€ï¼‰
				const delayCards = [...bingliangArea, ...lebuArea];

				// æ£€æŸ¥æ˜¯å¦æœ‰å¯è·å–çš„ç‰Œ
				if (delayCards.length > 0) {
					// æœ‰å»¶æ—¶é”¦å›Šï¼Œæ˜¾ç¤ºé€‰æ‹©å¯¹è¯æ¡†
					showShunshouDialog(card, index, delayCards);
				} else {
					// æ²¡æœ‰å»¶æ—¶é”¦å›Šï¼Œç›´æ¥ä½¿ç”¨å¡ç‰Œå¹¶æ£€æŸ¥æ¸è¥
					useShunshou(card, index, false);
				}
			}

			// æ˜¾ç¤ºé¡ºæ‰‹ç‰µç¾Šé€‰æ‹©å¯¹è¯æ¡†
			function showShunshouDialog(card, index, delayCards) {
				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';

				// åˆ›å»ºå¯¹è¯æ¡†
				const dialog = document.createElement('div');
				dialog.className = 'card-selector-modal';
				dialog.innerHTML = `
			        <h3>é¡ºæ‰‹ç‰µç¾Š - é€‰æ‹©è¦è·å–çš„å»¶æ—¶é”¦å›Š</h3>
			        <p>è¯·é€‰æ‹©è¦è·å–çš„ç‰Œï¼ˆç‚¹å‡»å¡ç‰Œé€‰æ‹©ï¼‰ï¼š</p>
			        <div id="delayCardsContainer" style="display: flex; flex-wrap: wrap; gap: 10px; margin: 15px 0;"></div>
			        <button id="noRemove" class="dialog-button" style="background:#C8E6C9;">
			            ä¸è·å–ï¼Œä»…ä½¿ç”¨æ•ˆæœ
			        </button>
			    `;

				// è·å–å¡ç‰Œå®¹å™¨
				const cardsContainer = dialog.querySelector('#delayCardsContainer');

				// æ·»åŠ æ¯å¼ å¯è·å–çš„å¡ç‰Œ
				delayCards.forEach((delayCard, i) => {
					const cardDiv = document.createElement('div');
					cardDiv.className = 'delay-card-selectable';
					cardDiv.innerHTML = `
			            <div>${delayCard.name}</div>
			            <div>${delayCard.suit}${getPointDisplay(delayCard.point)}</div>
			        `;

					// æ·»åŠ ç‚¹å‡»äº‹ä»¶
					cardDiv.addEventListener('click', () => {
						moveSpecificDelayCardToHand(delayCard);
						useShunshou(card, index, true); // trueè¡¨ç¤ºå·²è·å–ç‰Œ
						closeAllModals();
					});

					cardsContainer.appendChild(cardDiv);
				});

				// å…³é—­æ‰€æœ‰å¼¹çª—çš„å‡½æ•°
				const closeAllModals = () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
				};

				// "ä¸è·å–"æŒ‰é’®
				dialog.querySelector('#noRemove').addEventListener('click', () => {
					closeAllModals();
					useShunshou(card, index, false); // falseè¡¨ç¤ºæœªè·å–ç‰Œ
				});

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			}

			// ç§»åŠ¨æŒ‡å®šçš„å»¶æ—¶é”¦å›Šåˆ°æ‰‹ç‰ŒåŒº
			function moveSpecificDelayCardToHand(delayCard) {
				// ç¡®å®šå¡ç‰Œåœ¨å“ªä¸ªåŒºåŸŸ
				let area = null;
				let index = -1;

				// æ£€æŸ¥å…µç²®å¯¸æ–­åŒº
				index = bingliangArea.findIndex(c => c.uid === delayCard.uid);
				if (index !== -1) {
					area = bingliangArea;
				}
				// æ£€æŸ¥ä¹ä¸æ€èœ€åŒº
				else {
					index = lebuArea.findIndex(c => c.uid === delayCard.uid);
					if (index !== -1) {
						area = lebuArea;
					}
				}

				// å¦‚æœæ‰¾åˆ°å¡ç‰Œï¼Œåˆ™ç§»å‡ºæ‰‹ç‰ŒåŒº
				if (area && index !== -1) {
					const removedCard = area.splice(index, 1)[0];
					hand.push(removedCard); // æ·»åŠ åˆ°ç©å®¶æ‰‹ç‰Œ
					log(`è·å–${removedCard.name}: ${removedCard.suit}${getPointDisplay(removedCard.point)}`);

					// æ›´æ–°çŠ¶æ€æ˜¾ç¤º
					updateStatus();
				}
			}

			// ä½¿ç”¨é¡ºæ‰‹ç‰µç¾Šå¡ç‰Œ
			// movedCard: æ˜¯å¦å·²è·å–äº†ç‰Œ
			function useShunshou(card, index, movedCard) {
				// ä»æ‰‹ç‰Œç§»é™¤é¡ºæ‰‹ç‰µç¾Š
				const usedCard = hand.splice(index, 1)[0];

				// æ”¾å…¥å¼ƒç‰Œå †
				discardPile.push(usedCard);

				log(`ä½¿ç”¨é¡ºæ‰‹ç‰µç¾Š: ${usedCard.suit}${getPointDisplay(usedCard.point)}`);

				// å¦‚æœæ²¡æœ‰è·å–ç‰Œï¼Œéœ€è¦é¢å¤–æ‘¸ä¸€å¼ ç‰Œ
				if (!movedCard) {
					drawCards(1); // é¢å¤–æ‘¸ä¸€å¼ ç‰Œ
					log('æ²¡æœ‰è·å–ç‰Œï¼Œé¢å¤–æ‘¸ä¸€å¼ ç‰Œ');
				}

				// æ£€æŸ¥æ¸è¥æŠ€èƒ½
				if (lastUsedCard &&
					(usedCard.suit === lastUsedCard.suit ||
						usedCard.point === lastUsedCard.point)) {
					log('è§¦å‘æ¸è¥ï¼Œå†æ‘¸ä¸€å¼ ç‰Œï¼');
					drawCards(1);
				}

				// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œ
				lastUsedCard = usedCard;

				// æ›´æ–°ç•Œé¢
				updateStatus();
				updateUI();
			}

			// å¤„ç†å»¶æ—¶é”¦å›Šç‰Œä½¿ç”¨
			function handleDelayCard(card, index) {
				let targetArea, areaName, maxCards;

				switch (card.name) {
					case "å…µç²®å¯¸æ–­":
						targetArea = bingliangArea;
						areaName = "å…µç²®å¯¸æ–­";
						maxCards = MAX_DELAY_CARDS;
						break;
					case "ä¹ä¸æ€èœ€":
						targetArea = lebuArea;
						areaName = "ä¹ä¸æ€èœ€";
						maxCards = MAX_DELAY_CARDS;
						break;
					case "é—ªç”µ":
						targetArea = shandianArea;
						areaName = "é—ªç”µ";
						maxCards = MAX_SHANDIAN;
						break;
					default:
						return false;
				}

				if (targetArea.length >= maxCards) {
					alert(`${areaName}å·²è¾¾ä¸Šé™ï¼ˆ${maxCards}å¼ ï¼‰ï¼Œæ— æ³•ä½¿ç”¨ï¼`);
					return true;
				}

				// ä»æ‰‹ç‰Œç§»é™¤
				const usedCard = hand.splice(index, 1)[0];

				// æ”¾å…¥çŠ¶æ€åŒº
				targetArea.push(usedCard);

				log(`ä½¿ç”¨${card.name}ï¼Œæ”¾å…¥${areaName}åŒº`);

				// æ›´æ–°çŠ¶æ€
				updateStatus();
				updateUI();

				// æ£€æŸ¥æŠ€èƒ½
				if (lastUsedCard &&
					(usedCard.suit === lastUsedCard.suit ||
						usedCard.point === lastUsedCard.point)) {
					log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
					drawCards(1);
				}

				// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œ
				lastUsedCard = usedCard;

				return true;
			}

			// æ¸…ç©ºå»¶æ—¶é”¦å›ŠåŒº
			function clearDelayAreas() {
				if (bingliangArea.length > 0 || lebuArea.length > 0 || shandianArea.length > 0) {
					log(`ç»“æŸå‡ºç‰Œé˜¶æ®µï¼Œæ¸…ç©ºå»¶æ—¶é”¦å›ŠåŒº`);
				}

				// å…µç²®å¯¸æ–­åŒº
				bingliangArea.forEach(card => {
					discardPile.push(card);
					log(`å¼ƒç½®å…µç²®å¯¸æ–­: ${card.suit}${getPointDisplay(card.point)}`);
				});
				bingliangArea = [];

				// ä¹ä¸æ€èœ€åŒº
				lebuArea.forEach(card => {
					discardPile.push(card);
					log(`å¼ƒç½®ä¹ä¸æ€èœ€: ${card.suit}${getPointDisplay(card.point)}`);
				});
				lebuArea = [];

				// é—ªç”µåŒº
				shandianArea.forEach(card => {
					discardPile.push(card);
					log(`å¼ƒç½®é—ªç”µ: ${card.suit}${getPointDisplay(card.point)}`);
				});
				shandianArea = [];

				updateStatus();
			}

			//äº”è°·ä¸°ç™»å¯¹è¯æ¡†
			function showWugufengdengDialog(card, index) {
				// æ£€æŸ¥ç‰Œå †æ˜¯å¦è¶³å¤Ÿ
				if (deck.length < 3) {
					alert(`ç‰Œå †ä¸è¶³3å¼ ï¼Œæ— æ³•ä½¿ç”¨äº”è°·ä¸°ç™»ï¼å½“å‰ç‰Œå †: ${deck.length}å¼ `);
					return;
				}

				// åˆ›å»ºæ¨¡æ€èƒŒæ™¯
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';
				overlay.style.zIndex = '10000';

				// åˆ›å»ºå¯¹è¯æ¡†
				const dialog = document.createElement('div');
				dialog.className = 'wugufengdeng-dialog';
				dialog.style = `
			        position: fixed;
			        top: 50%;
			        left: 50%;
			        transform: translate(-50%, -50%);
			        background: #ffecb3;
			        padding: 20px;
			        border-radius: 10px;
			        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
			        z-index: 10001;
			        min-width: 350px;
			        text-align: center;
			    `;

				// æ·»åŠ æ ‡é¢˜
				dialog.innerHTML = `
			        <h3 style="color:#5d4037; margin-top:0;">äº”è°·ä¸°ç™» - è¯·é€‰æ‹©ä¸€å¼ ç‰Œ</h3>
			        <div class="card-options" style="display: flex; justify-content: center; gap: 20px; margin: 20px 0;">
			            <!-- å¡ç‰Œé€‰é¡¹å°†ç”±JSåŠ¨æ€æ·»åŠ  -->
			        </div>
			        <p style="color:#795548;">å‰©ä½™ä¸¤å¼ ç‰Œå°†ç½®å…¥å¼ƒç‰Œå †</p>
			    `;

				// ä»ç‰Œå †é¡¶éƒ¨å–ä¸‰å¼ ç‰Œ
				const cardsToShow = deck.slice(0, 3);
				const cardOptions = dialog.querySelector('.card-options');

				// åˆ›å»ºä¸‰å¼ ç‰Œçš„é€‰é¡¹
				cardsToShow.forEach((cardObj, i) => {
					const cardDiv = document.createElement('div');
					cardDiv.className = 'wugufengdeng-card';
					cardDiv.style = `
			            border: 2px solid #8d6e63;
			            border-radius: 8px;
			            padding: 15px;
			            background: #fff8e1;
			            cursor: pointer;
			            transition: all 0.3s;
			            min-width: 100px;
			        `;

					cardDiv.innerHTML = `
			            <div style="font-size: 18px; font-weight: bold; color:#5d4037;">${cardObj.name}</div>
			            <div style="font-size: 24px;">${cardObj.suit}${getPointDisplay(cardObj.point)}</div>
			            <div style="font-size: 14px; color:#8d6e63;">ç‚¹å‡»é€‰æ‹©</div>
			        `;

					cardDiv.addEventListener('click', () => handleWugufengdengSelection(card, index, i, cardsToShow));
					cardDiv.addEventListener('mouseenter', () => {
						cardDiv.style.transform = 'translateY(-5px)';
						cardDiv.style.boxShadow = '0 6px 12px rgba(0,0,0,0.15)';
					});
					cardDiv.addEventListener('mouseleave', () => {
						cardDiv.style.transform = 'none';
						cardDiv.style.boxShadow = 'none';
					});

					cardOptions.appendChild(cardDiv);
				});

				// æ·»åŠ å…ƒç´ åˆ°DOM
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			}

			// å¤„ç†äº”è°·ä¸°ç™»é€‰æ‹©
			function handleWugufengdengSelection(wugufengdengCard, handIndex, selectedIndex, shownCards) {
				// å…³é—­æ‰€æœ‰å¯¹è¯æ¡†
				document.querySelectorAll('.modal-backdrop, .wugufengdeng-dialog').forEach(el => el.remove());

				// é€‰ä¸­çš„å¡ç‰Œ
				const selectedCard = shownCards[selectedIndex];

				// ä»ç‰Œå †ä¸­ç§»é™¤å±•ç¤ºçš„ä¸‰å¼ ç‰Œ
				const removedCards = deck.splice(0, 3);

				// æ·»åŠ é€‰ä¸­çš„ç‰Œåˆ°ç©å®¶æ‰‹ç‰Œ
				hand.push(selectedCard);
				log(`äº”è°·ä¸°ç™»è·å¾—: ${selectedCard.name} ${selectedCard.suit}${getPointDisplay(selectedCard.point)}`);

				// å…¶ä½™ä¸¤å¼ ç‰Œç½®å…¥å¼ƒç‰Œå †
				shownCards.forEach((card, i) => {
					if (i !== selectedIndex) {
						discardPile.push(card);
						log(`å¼ƒç½®: ${card.name} ${card.suit}${getPointDisplay(card.point)}`);
					}
				});

				// ä»æ‰‹ç‰Œä¸­ç§»é™¤äº”è°·ä¸°ç™»
				const usedCard = hand.splice(handIndex, 1)[0];
				discardPile.push(usedCard);
				log(`ä½¿ç”¨äº”è°·ä¸°ç™»`);

				// æ£€æŸ¥æ¸è¥æŠ€èƒ½
				if (lastUsedCard && (wugufengdengCard.suit === lastUsedCard.suit || wugufengdengCard.point === lastUsedCard
						.point)) {
					log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
					drawCards(1);
				}

				// æ›´æ–°æœ€åä½¿ç”¨çš„å¡ç‰Œ
				lastUsedCard = wugufengdengCard;

				// æ›´æ–°ç•Œé¢
				updateUI();
				updateRemaining();

				// æ˜¾ç¤ºæ“ä½œåé¦ˆ
				showFeedback(`å·²é€‰æ‹©: ${selectedCard.name}`);
			}

			// æ·»åŠ åé¦ˆæ¶ˆæ¯å‡½æ•°
			function showFeedback(message) {
				const feedback = document.createElement('div');
				feedback.textContent = message;
				feedback.style = `
			        position: fixed;
			        top: 20px;
			        left: 50%;
			        transform: translateX(-50%);
			        padding: 12px 25px;
			        background: #4CAF50;
			        color: white;
			        border-radius: 30px;
			        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
			        z-index: 10000;
			        font-weight: bold;
			        animation: fadeInOut 2.5s forwards;
			    `;

				// æ·»åŠ æ·¡å…¥æ·¡å‡ºåŠ¨ç”»
				const style = document.createElement('style');
				style.textContent = `
			        @keyframes fadeInOut {
			            0% { opacity: 0; top: 10px; }
			            20% { opacity: 1; top: 20px; }
			            80% { opacity: 1; top: 20px; }
			            100% { opacity: 0; top: 10px; }
			        }
			    `;
				document.head.appendChild(style);

				document.body.appendChild(feedback);

				// 2.5ç§’åç§»é™¤
				setTimeout(() => {
					if (document.body.contains(feedback)) {
						document.body.removeChild(feedback);
					}
				}, 2500);
			}


			function showChainDialog(card, index) {
				const dialog = document.createElement('div');
				dialog.style = `
	           position: fixed;
	           top: 50%;
	           left: 50%;
	           transform: translate(-50%, -50%);
	           background: white;
	           padding: 20px;
	           border: 2px solid #666;
	           z-index: 10000;
	           box-shadow: 0 0 10px rgba(0,0,0,0.5);
	       `;
				dialog.innerHTML = `
	           <h3>é“ç´¢è¿ç¯æ•ˆæœé€‰æ‹©</h3>
	           <p>è¯·é€‰æ‹©è¦æ‰§è¡Œçš„æ“ä½œï¼š</p>
	           <button id="func1">åŠŸèƒ½1ï¼šé‡é“¸æ‘¸ç‰Œ</button>
	           <button id="func2">åŠŸèƒ½2ï¼šä½¿ç”¨æ£€ç´¢</button>
	           <button id="cancel">å–æ¶ˆ</button>
	       `;
				const overlay = document.createElement('div');
				overlay.style = `
	           position: fixed;
	           top: 0;
	           left: 0;
	           right: 0;
	           bottom: 0;
	           background: rgba(0,0,0,0.5);
	           z-index: 9999;
	       `;
				dialog.querySelector('#func1').addEventListener('click', () => {
					hand.splice(index, 1);
					discardPile.push(card);
					drawCards(1);
					log(`é‡é“¸é“ç´¢è¿ç¯ï¼Œæ‘¸1å¼ ç‰Œ`);
					cleanupDialog();
				});
				dialog.querySelector('#func2').addEventListener('click', () => {
					if (lastUsedCard && (card.suit === lastUsedCard.suit || card.point === lastUsedCard.point)) {
						log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
						drawCards(1);
					}
					lastUsedCard = card;
					discardPile.push(hand.splice(index, 1)[0]);
					log(`ä½¿ç”¨é“ç´¢è¿ç¯ï¼ŒèŠ±è‰²${card.suit} ç‚¹æ•°${getPointDisplay(card.point)}`);
					cleanupDialog();
				});
				dialog.querySelector('#cancel').addEventListener('click', cleanupDialog);

				function cleanupDialog() {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					updateUI();
				}
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			}

			function showJiedaoDialog(card, index) {
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';
				const dialog = document.createElement('div');
				dialog.className = 'card-selector-modal';
				dialog.innerHTML = `
			        <h3>å€Ÿåˆ€æ€äººæ•ˆæœé€‰æ‹©</h3>
			        <p>è¯·é€‰æ‹©è¦æ‰§è¡Œçš„æ“ä½œï¼š</p>
			        <div style="display: flex; flex-direction: column; gap: 10px;">
			            <button id="func1" class="dialog-button">åŠŸèƒ½1ï¼šæ£€ç´¢æ­¦å™¨</button>
			            <button id="func2" class="dialog-button">åŠŸèƒ½2ï¼šä½¿ç”¨é—ª</button>
			            <button id="cancel" class="dialog-button cancel">å–æ¶ˆ</button>
			        </div>
			    `;
				const closeAllModals = () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
				};
				dialog.querySelector('#func1').addEventListener('click', () => {
					closeAllModals();
					const weaponCards = deck.filter(c => cardCategories.weapon.includes(c.name));
					if (weaponCards.length === 0) {
						alert("ç‰Œå †ä¸­æ²¡æœ‰æ­¦å™¨ç‰Œï¼");
						return;
					}
					const weaponCard = weaponCards[0];
					const deckIndex = deck.findIndex(c => c.uid === weaponCard.uid);
					if (deckIndex === -1) {
						logError(`æ­¦å™¨ç‰Œ ${weaponCard.name} ä¸å­˜åœ¨äºç‰Œå †ä¸­`);
						return;
					}
					const [removed] = deck.splice(deckIndex, 1);
					hand.push(removed);
					log(`æ£€ç´¢è·å¾—æ­¦å™¨ï¼š${removed.name} ${removed.suit}${getPointDisplay(removed.point)}`);
					finalizeJiedao(card, index);
				});
				dialog.querySelector('#func2').addEventListener('click', () => {
					closeAllModals();
					const shanCards = hand.filter(c => c.name === "é—ª");
					if (shanCards.length === 0) {
						showNoShanDialog(card, index);
					} else {
						showShanSelection(shanCards, card, index);
					}
					finalizeJiedao(card, index);
				});
				dialog.querySelector('#cancel').addEventListener('click', () => {
					closeAllModals();
					log("å–æ¶ˆä½¿ç”¨å€Ÿåˆ€æ€äºº");
				});
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
				overlay.addEventListener('click', (e) => {
					if (e.target === overlay) {
						closeAllModals();
						log("å–æ¶ˆä½¿ç”¨å€Ÿåˆ€æ€äºº");
					}
				});
			}

			function showNoShanDialog(card, index) {
				const dialog = document.createElement('div');
				dialog.className = 'card-selector-modal';
				dialog.innerHTML = `
			        <h3>æ²¡æœ‰é—ªç‰Œ</h3>
			        <p>è¯·é€‰æ‹©åç»­æ“ä½œï¼š</p>
			        <button class="dialog-button" id="cancelUse">å–æ¶ˆä½¿ç”¨</button>
			        <button class="dialog-button" id="noShan">åšæŒä¸å‡ºé—ª</button>
			    `;
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';
				dialog.querySelector('#cancelUse').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
				});
				dialog.querySelector('#noShan').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					peachCount = Math.min(peachCount + 1, 3);
					log(`ä¸å‡ºé—ªï¼Œæ¡ƒå¯ç”¨æ¬¡æ•°+1ï¼Œå½“å‰ï¼š${peachCount}`);
					finalizeJiedao(card, index);
				});
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			}

			function showShanSelection(shanCards, card, index) {
				const dialog = document.createElement('div');
				dialog.className = 'card-selector-modal';
				dialog.innerHTML = `
			        <h3>é€‰æ‹©è¦ä½¿ç”¨çš„é—ªç‰Œ</h3>
			        <div id="shanList" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0;">
			            ${shanCards.map((c, i) => `
			                <button class="shan-card" data-index="${i}">
			                    ${c.suit}${getPointDisplay(c.point)}
			                </button>
			            `).join('')}
			        </div>
			        <button class="dialog-button cancel" id="cancelShan">å–æ¶ˆä½¿ç”¨é—ª</button>
			    `;
				const overlay = document.createElement('div');
				overlay.className = 'modal-backdrop';
				dialog.querySelectorAll('.shan-card').forEach(btn => {
					btn.addEventListener('click', (e) => {
						const idx = parseInt(e.target.dataset.index);
						const selectedCard = shanCards[idx];
						const handIndex = hand.findIndex(c => c.uid === selectedCard.uid);
						if (handIndex > -1) {
							const [removed] = hand.splice(handIndex, 1);
							discardPile.push(removed);
							log(`ä½¿ç”¨é—ªç‰Œï¼š${removed.suit}${getPointDisplay(removed.point)}`);
						}
						document.body.removeChild(overlay);
						document.body.removeChild(dialog);
						finalizeJiedao(card, index);
					});
				});
				dialog.querySelector('#cancelShan').addEventListener('click', () => {
					document.body.removeChild(overlay);
					document.body.removeChild(dialog);
					peachCount = Math.min(peachCount + 1, 3);
					log(`å–æ¶ˆä½¿ç”¨é—ªï¼Œæ¡ƒå¯ç”¨æ¬¡æ•°+1ï¼Œå½“å‰ï¼š${peachCount}`);
					finalizeJiedao(card, index);
				});
				document.body.appendChild(overlay);
				document.body.appendChild(dialog);
			}

			function finalizeJiedao(card, index) {
				const jiedaoCard = hand.splice(index, 1)[0];
				discardPile.push(jiedaoCard);
				if (lastUsedCard && (jiedaoCard.suit === lastUsedCard.suit ||
						jiedaoCard.point === lastUsedCard.point)) {
					log('è§¦å‘æ¸è¥ï¼Œæ‘¸ä¸€å¼ ç‰Œï¼');
					drawCards(1);
				}
				lastUsedCard = jiedaoCard;
				updateUI();
				updateStatus();
			}

			function cleanupDialog() {
				const dialogs = document.querySelectorAll('.modal-backdrop, .card-selector-modal');
				dialogs.forEach(dialog => dialog.remove());
			}

			function updateUI() {
				// æ›´æ–°é˜¶æ®µä¿¡æ¯
				const stageInfo = document.getElementById('stageInfo');
				if (stageInfo) {
					stageInfo.textContent = `å½“å‰é˜¶æ®µï¼š${phase}é˜¶æ®µ`;
				}
			
				// æ›´æ–°æ‰‹ç‰Œæ˜¾ç¤º
				const handDiv = document.getElementById('hand');
				handDiv.innerHTML = '<h3>æ‰‹ç‰Œ</h3>';
			
				// éå†æ‰‹ç‰Œ
				hand.forEach((card, i) => {
					const div = document.createElement('div');
					div.className = 'card';
			
					// æ€ç±»å¡ç‰Œç¦ç”¨æ£€æŸ¥
					if (['æ€', 'ç«æ€', 'é›·æ€'].includes(card.name)) {
						if (!hasZhugeLianNu && usedKillCount >= 2) {
							div.classList.add('disabled');
						}
					}
			
			
					// æ¡ƒç¦ç”¨æ£€æŸ¥
					if (card.name === "æ¡ƒ" && peachCount <= 0) {
						div.classList.add('disabled');
					}
			
					// é…’ç¦ç”¨æ£€æŸ¥
					if (card.name === "é…’" && wineCount <= 0) {
						div.classList.add('disabled');
					}
			
					// é—ªç¦ç”¨å¤„ç†
					if (card.name === 'é—ª') {
						div.classList.add('disabled');
						div.onclick = () => alert("å‡ºç‰Œé˜¶æ®µæ— æ³•ä½¿ç”¨é—ªï¼");
					}
			
					// æ— æ‡ˆå¯å‡»ç¦ç”¨å¤„ç†
					if (card.name === 'æ— æ‡ˆå¯å‡»') {
						div.classList.add('disabled');
						div.onclick = () => alert("å‡ºç‰Œé˜¶æ®µæ— æ³•ä½¿ç”¨æ— æ‡ˆå¯å‡»");
					}
			
					// å»¶æ—¶é”¦å›Šç‰Œç¦ç”¨æ£€æŸ¥
					if (card.name === "å…µç²®å¯¸æ–­" && bingliangArea.length >= MAX_DELAY_CARDS) {
						div.classList.add('disabled');
						div.onclick = () => alert("å…µç²®å¯¸æ–­å·²è¾¾ä¸Šé™ï¼Œæ— æ³•ä½¿ç”¨ï¼");
					}
			
					if (card.name === "ä¹ä¸æ€èœ€" && lebuArea.length >= MAX_DELAY_CARDS) {
						div.classList.add('disabled');
						div.onclick = () => alert("ä¹ä¸æ€èœ€å·²è¾¾ä¸Šé™ï¼Œæ— æ³•ä½¿ç”¨ï¼");
					}
			
					if (card.name === "é—ªç”µ" && shandianArea.length >= MAX_SHANDIAN) {
						div.classList.add('disabled');
						div.onclick = () => alert("é—ªç”µå·²è¾¾ä¸Šé™ï¼Œæ— æ³•ä½¿ç”¨ï¼");
					}
			
			
					// è®¾ç½®å¡ç‰Œå†…å®¹
					div.innerHTML = `${card.name}<br>${card.suit}${getPointDisplay(card.point)}`;
			
					// æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆç¦ç”¨å¡ç‰Œé™¤å¤–ï¼‰
					if (!div.classList.contains('disabled')) {
						div.onclick = () => useCard(card, i);
					}
			
					// æ·»åŠ åˆ°æ‰‹ç‰ŒåŒºåŸŸ
					handDiv.appendChild(div);
				});
			
				// æ›´æ–°æŒ‰é’®çŠ¶æ€
				document.getElementById('playBtn').disabled = phase !== 'æ‘¸ç‰Œ';
				document.getElementById('endPlayBtn').disabled = phase !== 'å‡ºç‰Œ';
			}

			function endPlayPhase() {
				phase = 'å‡†å¤‡';
				lastUsedCard = null;
				usedKillCount = 0;
				document.getElementById('drawBtn').disabled = false;
				document.getElementById('endPlayBtn').disabled = true;
				document.getElementById('playBtn').disabled = true;
				// é‡ç½®å½“å‰å›åˆä¼¤å®³å’Œé…’æ•ˆæœ
				currentTurnDamage = 0;
				wineEffect = false;
				if (currentWeapon !== "è¯¸è‘›è¿å¼©") {
					killCount = 2;
					hasZhugeLianNu = false;
				} else {
					hasZhugeLianNu = true;
					log("ä¿ç•™è¯¸è‘›è¿å¼©æ•ˆæœï¼Œæ€æ¬¡æ•°ä¿æŒæ— é™");
				}
				wineCount = 1;
				updateStatus();
				// æ¸…ç©ºå»¶æ—¶é”¦å›ŠåŒº
				clearDelayAreas();
				updateUI();
				log("å·²ç»“æŸå‡ºç‰Œé˜¶æ®µ");
			}

// æ·»åŠ æ•´ç†æ‰‹ç‰ŒåŠŸèƒ½
			document.getElementById('organizeHandBtn').addEventListener('click', function() {
				const button = this;

				// æ£€æŸ¥å†·å´çŠ¶æ€
				if (button.disabled) return;

				// è®¾ç½®æŒ‰é’®ä¸ºç¦ç”¨çŠ¶æ€ï¼ˆå†·å´ä¸­ï¼‰
				button.disabled = true;
				button.textContent = 'å†·å´ä¸­...';
				button.style.backgroundColor = '#999';

				// æ•´ç†æ‰‹ç‰Œ
				organizeHand();

				// æ›´æ–°UI
				updateUI();

				// 3ç§’åæ¢å¤æŒ‰é’®
				setTimeout(() => {
					button.disabled = false;
					button.textContent = 'æ•´ç†æ‰‹ç‰Œ';
					button.style.backgroundColor = '#4CAF50';
				}, 3000);
			});

			// æ•´ç†æ‰‹ç‰Œå‡½æ•°
			function organizeHand() {
				// å®šä¹‰æ’åºä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰
				const priority = {
					'è¯¸è‘›è¿å¼©': 0,
					'æ€': 1,
					'ç«æ€': 1,
					'é›·æ€': 1,
					'é…’': 2,
					'æ¡ƒ': 5,
					'é—ª': 6,
					'æ— æ‡ˆå¯å‡»': 7
				};

				// é”¦å›Šç‰Œä¼˜å…ˆçº§ï¼ˆæ•°å€¼åœ¨3-4ä¹‹é—´ï¼‰
				const trickCards = [
					'æ— ä¸­ç”Ÿæœ‰', 'è¿‡æ²³æ‹†æ¡¥', 'é¡ºæ‰‹ç‰µç¾Š', 'å†³æ–—', 'å€Ÿåˆ€æ€äºº',
					'å—è›®å…¥ä¾µ', 'ä¸‡ç®­é½å‘', 'äº”è°·ä¸°ç™»', 'æ¡ƒå›­ç»“ä¹‰', 'é“ç´¢è¿ç¯',
					'ç«æ”»', 'å…µç²®å¯¸æ–­', 'ä¹ä¸æ€èœ€', 'é—ªç”µ'
				];

				// è£…å¤‡ç‰Œä¼˜å…ˆçº§ï¼ˆæ•°å€¼åœ¨4-5ä¹‹é—´ï¼‰
				const equipmentCards = [
				        'é’é¾™åƒæœˆåˆ€', 'ä¸ˆå…«è›‡çŸ›', 'è´¯çŸ³æ–§', 'æ–¹å¤©ç”»æˆŸ', 'éº’éºŸå¼“',
				        'é›Œé›„åŒè‚¡å‰‘', 'å¯’å†°å‰‘', 'é’é‡­å‰‘', 'é’è™¹å‰‘',
				        'æœ±é›€ç¾½æ‰‡', 'å…«å¦é˜µ', 'ä»ç‹ç›¾', 'ç™½é“¶ç‹®å­', 'è—¤ç”²',
				        'èµ¤å…”', 'å¤§å®›', 'çˆªé»„é£ç”µ', 'çš„å¢', 'ç»å½±', 'ç´«éª'
				    ];

				// å¯¹æ¯å¼ ç‰Œåˆ†é…ä¼˜å…ˆçº§å’Œåç§°æ’åºé”®
				hand.forEach(card => {
					// å·²ç»å®šä¹‰ä¼˜å…ˆçº§çš„å¡ç‰Œ
					if (priority.hasOwnProperty(card.name)) {
						card.sortPriority = priority[card.name];
						card.nameSortKey = card.name; // ç”¨äºåŒåæ’åº
					}
					// é”¦å›Šç‰Œ
					else if (trickCards.includes(card.name)) {
						card.sortPriority = 3;
						card.nameSortKey = card.name; // ç”¨äºåŒåæ’åº
					}
					// è£…å¤‡ç‰Œï¼ˆé™¤è¯¸è‘›è¿å¼©å¤–ï¼‰
					else if (equipmentCards.includes(card.name)) {
						card.sortPriority = 4;
						card.nameSortKey = card.name; // ç”¨äºåŒåæ’åº
					}
					// æœªåˆ†ç±»çš„å¡ç‰Œï¼ˆä¼˜å…ˆçº§æœ€ä½ï¼‰
					else {
						card.sortPriority = 8;
						card.nameSortKey = card.name; // ç”¨äºåŒåæ’åº
					}
				});

				// æŒ‰ä¼˜å…ˆçº§æ’åºï¼Œç„¶åæŒ‰åç§°åˆ†ç»„
				const groupedHand = {};

				// é¦–å…ˆæŒ‰ä¼˜å…ˆçº§åˆ†ç»„
				hand.forEach(card => {
					if (!groupedHand[card.sortPriority]) {
						groupedHand[card.sortPriority] = [];
					}
					groupedHand[card.sortPriority].push(card);
				});

				// å¯¹æ¯ä¸ªä¼˜å…ˆçº§ç»„å†…çš„ç‰ŒæŒ‰åç§°åˆ†ç»„
				Object.keys(groupedHand).forEach(priority => {
					const samePriorityGroup = {};

					// æŒ‰åç§°åˆ†ç»„
					groupedHand[priority].forEach(card => {
						if (!samePriorityGroup[card.nameSortKey]) {
							samePriorityGroup[card.nameSortKey] = [];
						}
						samePriorityGroup[card.nameSortKey].push(card);
					});

					// å¯¹åŒåç§°çš„ç‰ŒæŒ‰èŠ±è‰²å’Œç‚¹æ•°æ’åº
					const sortedGroups = [];
					Object.keys(samePriorityGroup).sort().forEach(nameKey => {
						// å¯¹åŒä¸€åç§°çš„ç‰Œè¿›è¡Œæ’åº
						samePriorityGroup[nameKey].sort((a, b) => {
							// æŒ‰èŠ±è‰²æ’åº
							const suits = ['â™ ', 'â™¥', 'â™£', 'â™¦'];
							const suitA = suits.indexOf(a.suit);
							const suitB = suits.indexOf(b.suit);
							if (suitA !== suitB) {
								return suitA - suitB;
							}

							// æŒ‰ç‚¹æ•°æ’åº
							return a.point - b.point;
						});

						// å°†æ’åºåçš„åŒåç‰Œç»„æ·»åŠ åˆ°ç»“æœä¸­
						sortedGroups.push(...samePriorityGroup[nameKey]);
					});

					// æ›´æ–°å½“å‰ä¼˜å…ˆçº§ç»„çš„ç‰Œ
					groupedHand[priority] = sortedGroups;
				});

				// é‡æ–°ç»„åˆæ‰‹ç‰Œï¼šæŒ‰ä¼˜å…ˆçº§é¡ºåºï¼Œç„¶åæŒ‰åç§°æ’åº
				hand = [];
				Object.keys(groupedHand).sort((a, b) => a - b).forEach(priority => {
					hand.push(...groupedHand[priority]);
				});

				// è®°å½•æ—¥å¿—
				log("å·²æ•´ç†æ‰‹ç‰Œ");
			}
			function discardCard(card) {
				if (card.name === "è¯¸è‘›è¿å¼©") {
					hasZhugeLianNu = false;
					log("å¤±å»è¯¸è‘›è¿å¼©ï¼Œæ¢å¤æ¬¡æ•°é™åˆ¶");
					updateStatus();
				}

			}

			function updateHeaderPlaceholder() {
				const header = document.querySelector('.header');
				const placeholder = document.querySelector('.header-placeholder');
				if (header && placeholder) {
					const height = header.offsetHeight + 5;
					placeholder.style.height = `${height}px`;
				}
			}
			window.addEventListener('DOMContentLoaded', updateHeaderPlaceholder);
			window.addEventListener('resize', updateHeaderPlaceholder);

			function isWindowsOS() {
				return navigator.userAgent.indexOf('Win') > -1;
			}

			function generateSecurityLog() {
				const timeStamp = new Date().toISOString().replace(/T/, ' ').replace(/\..+/, '');
				const deckDetails = deck.map((card, index) =>
					`[${index + 1}] ${card.name} - èŠ±è‰²:${card.suit} ç‚¹æ•°:${getPointDisplay(card.point)} UID:${card.uid}`
				).join('\n');
				return `æ²®çˆ¹çº¢åˆ©æœŸæ¨¡æ‹Ÿå™¨å®‰å…¨æ—¥å¿—\n
	   ç”Ÿæˆæ—¶é—´: ${timeStamp}
	   ==================== MD5 & AES ====================
	   MD5æ ‡è¯†ç¬¦: ${currentMD5}
	   AESç¼–ç : ${currentAES}
	   =================== ç‰Œå †è¯¦ç»†ä¿¡æ¯ ===================
	   æ€»ç‰Œæ•°: ${deck.length}
	   å½“å‰ç‰Œå †é¡ºåº:
	   ${deckDetails}
	   ==================== ç³»ç»Ÿä¿¡æ¯ ======================
	   ç”¨æˆ·ç³»ç»Ÿ: ${navigator.userAgent}
	   `;
			}

			function showSecurityAlert() {
				const alertBox = document.createElement('div');
				alertBox.className = 'security-alert';
				alertBox.innerHTML = `
	           <strong>å®‰å…¨æç¤º</strong>
	           <p>ç”±äºä¿éšœç”¨æˆ·ä¿¡æ¯å®‰å…¨ï¼Œè¯¥åŠŸèƒ½ä»…é™Windowsç³»ç»Ÿç”¨æˆ·ä½¿ç”¨ã€‚è¯¥åŠŸèƒ½ä¼šåœ¨æ‚¨çš„æµè§ˆå™¨ä¸­ç”Ÿæˆä¸€ä¸ªåŒ…å«æœ¬æ¬¡ç‰Œå †çš„MD5ã€AESç¼–ç åŠç‰Œå †è¯¦ç»†ä¿¡æ¯çš„txtæ–‡ä»¶ã€‚</p>
	           <p>è¯·é—®æ˜¯å¦ç»§ç»­åˆ›å»ºï¼Ÿ</p>
	           <button class="confirm">æ˜¯ï¼Œç»§ç»­åˆ›å»º</button>
	           <button class="cancel">å¦ï¼Œå–æ¶ˆæ“ä½œ</button>
	       `;
				const backdrop = document.createElement('div');
				backdrop.style = `
	           position: fixed;
	           top:0; left:0; right:0; bottom:0;
	           background: rgba(0,0,0,0.5);
	           display: flex;
	           align-items: center;
	           justify-content: center;
	           z-index: 9999;
	       `;
				backdrop.appendChild(alertBox);
				document.body.appendChild(backdrop);
				return new Promise(resolve => {
					alertBox.querySelector('.confirm').onclick = () => {
						document.body.removeChild(backdrop);
						resolve(true);
					};
					alertBox.querySelector('.cancel').onclick = () => {
						document.body.removeChild(backdrop);
						resolve(false);
					};
				});
			}
			document.getElementById('exportLog').addEventListener('click', async () => {
				if (!isWindowsOS()) {
					alert('å½“å‰åŠŸèƒ½ä»…é™Windowsç³»ç»Ÿç”¨æˆ·ä½¿ç”¨');
					return;
				}
				const userConfirm = await showSecurityAlert();
				if (!userConfirm) {
					log('ç”¨æˆ·å–æ¶ˆäº†æ—¥å¿—ç”Ÿæˆ');
					return;
				}
				try {
					const content = generateSecurityLog();
					const blob = new Blob([content], {
						type: 'text/plain;charset=utf-8'
					});
					const downloadLink = document.createElement('a');
					downloadLink.href = URL.createObjectURL(blob);
					downloadLink.download = `PileLog_${Date.now()}.txt`;
					document.body.appendChild(downloadLink);
					downloadLink.click();
					document.body.removeChild(downloadLink);
					log('å®‰å…¨æ—¥å¿—æ–‡ä»¶å·²ç”Ÿæˆ');
				} catch (error) {
					console.error('å¯¼å‡ºå¤±è´¥:', error);
					log('å®‰å…¨æ—¥å¿—ç”Ÿæˆå¤±è´¥');
				}
			});

			function log(message) {
				const logDiv = document.getElementById('log');
				const container = document.getElementById('log-container');
				const newEntry = document.createElement('p');
				newEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
				logDiv.appendChild(newEntry);
				container.scrollTop = 0;
			}
			let isCollapsed = false;
			document.getElementById('toggleCounter').addEventListener('click', () => {
				const counter = document.getElementById('remaining-counts');
				const btn = document.getElementById('toggleCounter');
				isCollapsed = !isCollapsed;
				counter.classList.toggle('collapsed');
				btn.innerHTML = isCollapsed ? 'â–¶ å±•å¼€' : 'â–¼ æ”¶èµ·';
			});
			let isStatusAreaCollapsed = false;

			document.getElementById('toggleStatusArea').addEventListener('click', () => {
				const statusArea = document.getElementById('status-area');
				const btn = document.getElementById('toggleStatusArea');

				isStatusAreaCollapsed = !isStatusAreaCollapsed;

				if (isStatusAreaCollapsed) {
					statusArea.classList.add('collapsed');
					btn.innerHTML = 'â–¶ å±•å¼€';
				} else {
					statusArea.classList.remove('collapsed');
					btn.innerHTML = 'â–¼ æ”¶èµ·';
				}
			});


			function toggleSection(sectionId, button, isCollapsedFlag) {
				const section = document.getElementById(sectionId);
				isCollapsedFlag = !isCollapsedFlag;
				section.classList.toggle('collapsed');
				button.innerHTML = isCollapsedFlag ? 'â–¶ å±•å¼€' : 'â–¼ æ”¶èµ·';
				return isCollapsedFlag;
			}
			document.getElementById('toggleMD5AES').addEventListener('click', () => {
				isMD5AESCollapsed = toggleSection('md5aes-container',
					document.getElementById('toggleMD5AES'), isMD5AESCollapsed);
			});

			function handleKeyPress(event) {
				if (document.activeElement.tagName === 'INPUT') return;
				const reshuffleDisabled = document.getElementById('reshuffleBtn').disabled;
				const playBtnDisabled = document.getElementById('playBtn').disabled;
				const endPlayDisabled = document.getElementById('endPlayBtn').disabled;

				switch (event.key.toUpperCase()) {
					case 'Q':
						if (confirm("ç¡®å®šè¦å¼ºåˆ¶åˆ·æ–°é¡µé¢å—ï¼Ÿ")) {
							location.reload(true);
						}
						break;
					case '1':
						drawCards(1);
						break;
					case '2':
						drawCards(2);
						break;
					case '3':
						drawCards(3);
						break;
					case '4':
						drawCards(4);
						break;
					case 'W':
						revealDeck();
						break;
					case 'E':
						highlightZhugeLianNu();
						break;
					case 'R':
						initializeDeck();
						log("å¿«æ·é”®æ´—ç‰Œ");
						break;
					case 'T':
						if (!reshuffleDisabled) handleReshuffle();
						break;
					case 'A':
						if (phase === 'å‡†å¤‡') drawPhase();
						break;
					case 'S':
						if (!playBtnDisabled) playPhase();
						break;
					case 'D':
						if (!endPlayDisabled) endPlayPhase();
						break;
				}
				if ('QWEASDTR1234'.includes(event.key.toUpperCase())) {
					event.preventDefault();
				}
			}

			function showCardSelector() {
				const backdrop = document.createElement('div');
				backdrop.className = 'modal-backdrop';
				const modal = document.createElement('div');
				modal.className = 'card-selector-modal';
				modal.innerHTML = `
			    <h3>é€‰æ‹©è¦æ·»åŠ çš„å¡ç‰Œç±»å‹</h3>
			    <div id="cardButtons"></div>
			    <button onclick="this.parentElement.parentElement.remove()" 
			            style="margin-top:15px; padding:8px 20px;">
			      å…³é—­
			    </button>
			  `;
				const buttonsContainer = modal.querySelector('#cardButtons');
				const types = getAllCardTypes();
				types.forEach(type => {
					const btn = document.createElement('button');
					btn.className = 'card-button';
					btn.textContent = type;
					btn.onclick = () => {
						addSpecificCard(type);
						backdrop.remove();
					};
					buttonsContainer.appendChild(btn);
				});
				backdrop.appendChild(modal);
				document.body.appendChild(backdrop);
				backdrop.onclick = (e) => {
					if (e.target === backdrop) {
						backdrop.remove();
					}
				};
			}
			document.getElementById('testCardBtn').addEventListener('click', showCardSelector);

			function getAllCardTypes() {
				const typeSet = new Set();
				standardDeck.forEach(card => {
					if (deck.some(c => c.name === card.name)) {
						typeSet.add(card.name);
					}
				});
				return Array.from(typeSet).sort((a, b) => a.localeCompare(b, 'zh-Hans-CN'));
			}

			function addSpecificCard(cardName) {
				const availableCards = deck.filter(c => c.name === cardName);
				if (availableCards.length === 0) {
					alert(`ç‰Œå †ä¸­æ²¡æœ‰ã€${cardName}ã€‘ï¼`);
					log(`å°è¯•æ·»åŠ ${cardName}å¤±è´¥ï¼ˆç‰Œå †æ— æ­¤å¡ï¼‰`);
					return;
				}
				const randomBuffer = new Uint32Array(1);
				window.crypto.getRandomValues(randomBuffer);
				const selectedIndex = randomBuffer[0] % availableCards.length;
				const selectedCard = availableCards[selectedIndex];
				const deckIndex = deck.findIndex(c => c.uid === selectedCard.uid);
				if (deckIndex > -1) {
					const [removed] = deck.splice(deckIndex, 1);
					hand.push(removed);
					log(`æ‰‹åŠ¨æ·»åŠ å¡ç‰Œï¼š${removed.name} ${removed.suit}${getPointDisplay(removed.point)}`);
					updateUI();
					updateRemaining();
					generateDeckMD5();
					const feedback = document.createElement('div');
					feedback.textContent = `å·²æ·»åŠ ï¼š${removed.name}`;
					feedback.style =
						'position:fixed; top:20px; left:50%; transform:translateX(-50%); padding:10px; background:#4CAF50; color:white;';
					document.body.appendChild(feedback);
					setTimeout(() => feedback.remove(), 2000);
				}
			}

			function updateTooltipAlignment() {
				const tooltipContainers = document.querySelectorAll('.tooltip-container');
				tooltipContainers.forEach(container => {
					const button = container.querySelector('button');
					const tooltip = container.querySelector('.tooltip');
					if (button && tooltip) {
						const rect = button.getBoundingClientRect();
						const viewportWidth = window.innerWidth;
						const tooltipWidth = tooltip.offsetWidth || 350;
						const leftSpace = rect.left;
						const rightSpace = viewportWidth - rect.right;
						if (rightSpace >= tooltipWidth) {
							container.classList.remove('right-align');
						} else if (leftSpace >= tooltipWidth) {
							container.classList.add('right-align');
						} else {
							if (rightSpace > leftSpace) {
								container.classList.remove('right-align');
							} else {
								container.classList.add('right-align');
							}
						}
					}
				});
			}
			window.addEventListener('load', () => {
				setTimeout(updateTooltipAlignment, 100);
			});
			window.addEventListener('resize', updateTooltipAlignment);
			window.addEventListener('scroll', updateTooltipAlignment);
			document.querySelectorAll('.tooltip-container').forEach(container => {
				container.addEventListener('mouseenter', updateTooltipAlignment);
			});

			function initializeGame() {
				initializeDeck();
				initializeButtons();
				document.addEventListener('keydown', handleKeyPress);
				document.getElementById('testUniformBtn').style.display = isDevMode ? 'inline' : 'none';
			}
			document.getElementById('draw1Button').addEventListener('click', () => drawCards(1));
			document.getElementById('draw2Button').addEventListener('click', () => drawCards(2));
			document.getElementById('draw3Button').addEventListener('click', () => drawCards(3));
			document.getElementById('draw4Button').addEventListener('click', () => drawCards(4));
			document.getElementById('revealButton').addEventListener('click', revealDeck);
			document.getElementById('highlightButton').addEventListener('click', highlightZhugeLianNu);
			document.getElementById('shuffleButton').addEventListener('click', () => {
				initializeDeck();
				log("ç”¨æˆ·ç‚¹å‡»äº†é‡æ–°æ´—ç‰ŒæŒ‰é’®");
			});
			document.getElementById('reshuffleBtn').addEventListener('click', handleReshuffle);
			document.getElementById('drawBtn').addEventListener('click', drawPhase);
			document.getElementById('playBtn').addEventListener('click', playPhase);
			document.getElementById('reloadButton').addEventListener('click', () => {
				if (confirm("ç¡®å®šè¦å¼ºåˆ¶åˆ·æ–°é¡µé¢å—ï¼Ÿç½‘é¡µå°†å›åˆ°åˆå§‹é¡µé¢")) {
					location.reload(true);
				}
			});
			document.getElementById('endPlayBtn').addEventListener('click', endPlayPhase);
			document.getElementById('testUniformBtn').addEventListener('click', async () => {
				const userConfirm = await showPerformanceWarning();
				if (userConfirm) {
					console.log('å¼€å§‹æ‰§è¡Œå‡åŒ€æ€§æµ‹è¯•');
					testShuffleUniformity();
				}
			});
			initializeGame();
		</script>
		<footer class="site-footer">
			<div class="author-info">
				<p>
					ä½œè€…ï¼š <a href="https://space.bilibili.com/87412647?spm_id_from=333.1007.0.0"
						target="_blank">bilibiliæœˆãŒç¶ºéº—ã§ã™ã­_</a><br />
					è”ç³»æ–¹å¼ï¼š<a href="mailto:3099637681@qq.com" target="_blank">3099637681@qq.comï¼ˆQQåŒå·ï¼‰</a><br />
					æœ‰ä»€ä¹ˆæ–°åŠŸèƒ½æˆ–å»ºè®®æ¬¢è¿éªšæ‰°ï¼ˆè‘—åæ¥æ„ï¼‰<br />
					<a href="https://1145141919810tonny.github.io/sgsmoniqi/" target="_blank">ç‚¹å‡»æ­¤å¤„ä½¿ç”¨GitHub Pagesåœ¨çº¿æœåŠ¡</a>
				</p>
			</div>
			<div class="code-update">

				<a href="https://www.bilibili.com/read/readlist/rl929858?spm_id_from=333.1387.0.0" target="_blank"
					class="bili-button" rel="noopener noreferrer">
					[bilibili]è·å–æ›´æ–°åŠ¨æ€
				</a>
				<a href="https://github.com/1145141919810TONNY/sgsmoniqi/" target="_blank" class="buttoncopy"
					rel="noopener noreferrer">
					[GitHub]è·å–åç»­ä»£ç æ›´æ–°
				</a>
				<a href="https://gitcode.com/TONNY114514/sgsmnq?source_module=search_project" target="_blank"
					class="buttoncopy" rel="noopener noreferrer">
					[GitCode]è·å–åç»­ä»£ç æ›´æ–°(å›½å†…git)
				</a>
			</div>
			<div class="license-notice">
				<p>
					Copyright &copy; <span id="copyright-year">2025</span> bilibili æœˆãŒç¶ºéº—ã§ã™ã­_<br />
					Released under the
					<a href="MIT LICENSE.html" title="æŸ¥çœ‹MITè®¸å¯è¯" class="license-link" target="_blank">
						MIT License
					</a>
				</p>
				<p class="i18n-annotation">
					(æ³•å¾‹æ¡æ¬¾ä»¥è‹±æ–‡ç‰ˆ<a href="MIT LICENSE.html" target="_blank">LICENSE</a>æ–‡ä»¶ä¸ºå‡†)
				</p>
			</div>
		</footer>
	</body>
</html>
